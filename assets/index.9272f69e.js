!function(){let e;function t(e){Object.defineProperty(e,"__esModule",{value:!0,configurable:!0})}function r(e,t,r,o){Object.defineProperty(e,t,{get:r,set:o,enumerable:!0,configurable:!0})}function o(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},i={},s=n.parcelRequirec7f3;null==s&&((s=function(e){if(e in a)return a[e].exports;if(e in i){var t=i[e];delete i[e];var r={id:e,exports:{}};return a[e]=r,t.call(r.exports,r,r.exports),r.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){i[e]=t},n.parcelRequirec7f3=s);var l=s.register;l("fkeW0",function(e,o){t(e.exports),r(e.exports,"default",function(){return x});var n=s("djimy"),a=s("djoOt"),i=s("bA8zD"),l=s("4I7K4"),u=s("2lug4"),c=s("lbosM"),d=s("4fF5a"),p=s("2vvax"),f=s("1VbKL"),m=s("jrojO"),h=s("flGFW"),g=s("7dQGn"),b=s("f4LB1"),y=s("i5N9G"),_=s("dNJei"),S=s("8C4qt"),x=/*#__PURE__*/(0,n.defineComponent)({__name:"App",setup(e,{expose:t}){t();let r=(0,h.useOptionStore)(),{config:o}=(0,g.useConfigStore)(),s=(0,b.useAppStore)(),x=(0,y.useModelStore)();(0,n.watch)(()=>s.isFullscreen,e=>{console.log("Fullscreen toogled"),(0,S.ignorePromise)(e?document.documentElement.requestFullscreen():document.exitFullscreen())});let k=(0,n.ref)(!1),T=()=>{k.value=!k.value};(0,a.onKeyStroke)("c",T);let P=(0,n.computed)(()=>(0,_.Scores).circularity(x.record)),C=(0,n.computed)(()=>(0,_.Scores).userSatifaction(x.record)),I={options:r,config:o,appStore:s,modelStore:x,enableControlPanel:k,toggleControlPanel:T,circularityScore:P,userSatisfactionScore:C,PointerMarkerPanel:i.default,TuioMarkerPanel:l.default,ScoreItem:u.default,ControlPanel:c.default,TriggeredOverlay:d.default,BasicSlotGroup:p.default,ActionCardSlotGroup:f.default,EventCardSlotGroup:m.default};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}})}),l("bA8zD",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("k9l3C")).__esModule&&(o=o.default),o.render=s("dWDNN").render,o.__cssModules={},s("hfCe3").default(o),o.__scopeId="data-v-7331b8",o.__file="PointerMarkerPanel.vue";var n=o}),l("k9l3C",function(e,o){t(e.exports),r(e.exports,"default",function(){return d});var n=s("djimy"),a=s("hWymx"),i=s("9OMm5"),l=s("7Rjir"),u=s("dLTM2"),c=s("02fmQ"),d=/*#__PURE__*/(0,n.defineComponent)({__name:"PointerMarkerPanel",setup(e,{expose:t}){t();let{markerPositions:r,addMarker:o,moveMarker:s}=(0,c.useMarkerStore)(),d=(0,i.useArrayFilter)(r,({id:e})=>e.startsWith("pointer-marker-"));(0,l.POINTER_MARKER_COORDINATES).forEach(({x:e,y:t},r)=>o({id:`pointer-marker-${r}`,x:e,y:t}));let p=(0,n.ref)(null),f=new Map,m={markerPositions:r,addMarker:o,moveMarker:s,pointerMarkers:d,container:p,offsets:f,onPointerDown:(e,t)=>{let{target:r}=e;(0,a.strict)(null!==r&&r instanceof HTMLElement),r.setPointerCapture(e.pointerId),(0,a.strict)(null!==p.value);let o=p.value.getBoundingClientRect(),n={x:l.BOARD_WIDTH*e.clientX/o.width-t.x,y:l.BOARD_HEIGHT*e.clientY/o.height-t.y};f.set(t.id,n)},onPointerMove:(e,t)=>{let{target:r}=e;if((0,a.strict)(null!==r&&r instanceof HTMLElement),!r.hasPointerCapture(e.pointerId))return;(0,a.strict)(null!==p.value);let o=p.value.getBoundingClientRect(),n=f.get(t.id);(0,a.strict)(void 0!==n);// eslint-disable-next-line no-param-reassign
let i=l.BOARD_WIDTH*e.clientX/o.width-n.x,u=l.BOARD_HEIGHT*e.clientY/o.height-n.y;s({id:t.id,x:i,y:u})},onPointerUpOrCancel:(e,t)=>{let{target:r}=e;(0,a.strict)(null!==r&&r instanceof HTMLElement),r.releasePointerCapture(e.pointerId)},MarkerUnderlay:u.default};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}})}),l("7Rjir",function(e,t){r(e.exports,"CONFIG_URLS",function(){return n}),r(e.exports,"CONFIG_INJECTION_KEY",function(){return a}),r(e.exports,"BOARD_WIDTH",function(){return i}),r(e.exports,"BOARD_HEIGHT",function(){return s}),r(e.exports,"MARKER_CIRCLE_DIAMETER",function(){return l}),r(e.exports,"NUM_POINTER_MARKERS",function(){return u}),r(e.exports,"POINTER_MARKER_COORDINATES",function(){return c}),r(e.exports,"SLOT_CIRCLE_DIAMETER",function(){return d});let o=new URL("./config/",window.location.href),n=["general.yaml","model.yaml","simulation.yaml","parameter-transforms.yaml","interaction.yaml","triggers.yaml"].map(e=>new URL(e,o)),a=Symbol("config injection key"),i=3840,s=2160,l=74.3*i/1209.6,u=8,c=Array(u).fill(0).map(()=>({x:180,y:260})),d=l}),l("dLTM2",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("kpnqw")).__esModule&&(o=o.default),o.render=s("awOVi").render,o.__cssModules={},s("cdnTT").default(o),o.__scopeId="data-v-d66f6c",o.__file="MarkerUnderlay.vue";var n=o}),l("kpnqw",function(e,o){t(e.exports),r(e.exports,"default",function(){return i});var n=s("djimy"),a=s("7Rjir"),i=/*#__PURE__*/(0,n.defineComponent)({__name:"MarkerUnderlay",props:{markerId:{},x:{},y:{}},setup(e,{expose:t}){t();let r={props:e,get MARKER_CIRCLE_DIAMETER(){return a.MARKER_CIRCLE_DIAMETER}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}})}),l("awOVi",function(e,t){r(e.exports,"render",function(){return n});var o=s("djimy");function n(e,t,r,n,a,i){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"marker",style:(0,o.normalizeStyle)({"--marker-position-x":n.props.x,"--marker-position-y":n.props.y,"--marker-diameter":n.MARKER_CIRCLE_DIAMETER})},(0,o.toDisplayString)(n.props.markerId),5)}}),l("cdnTT",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("02fmQ",function(e,t){r(e.exports,"useMarkerStore",function(){return d});var o=s("kV0Ly"),n=s("djimy"),a=s("7Rjir"),i=s("flGFW"),l=s("46h5Q");s("h1KQv");var u=s("4Bz8r"),c=s("4IIOm");let d=(0,o.defineStore)("marker",()=>{let e=(0,i.useOptionStore)(),t=(0,n.ref)([]),r=e=>{let r=-1;do -1!==(r=t.value.findIndex(({id:t})=>t===e.id))&&t.value.splice(r,1);while(-1!==r)},o=e=>{r(e),t.value.push({...e})},s=e=>{let r=t.value.find(({id:t})=>t===e.id);if(void 0===r){o(e);return}r.x=e.x,r.y=e.y},d=new l.Tuio11EventEmitter;if(e.useTuioMarkers){let t=new u.Tuio11Client(new c.WebsocketTuioReceiver(e.tuioUrl));t.addTuioListener(d),/*
     * FIXME:
     *   This is a workaround to not miss the initial marker events that are emitted directly after the connection is
     *   established.
     */setTimeout(()=>t.connect(),0)}return d.on("tuio-object-add",e=>{o({id:`tuio-${e.sessionId}`,x:e.xPos*a.BOARD_WIDTH,y:e.yPos*a.BOARD_HEIGHT})}),d.on("tuio-object-update",e=>{s({id:`tuio-${e.sessionId}`,x:e.xPos*a.BOARD_WIDTH,y:e.yPos*a.BOARD_HEIGHT})}),d.on("tuio-object-remove",e=>{r({id:`tuio-${e.sessionId}`,x:e.xPos*a.BOARD_WIDTH,y:e.yPos*a.BOARD_HEIGHT})}),{markerPositions:(0,n.readonly)(t),removeMarker:r,addMarker:o,moveMarker:s}})}),l("flGFW",function(e,t){r(e.exports,"useOptionStore",function(){return a});var o=s("kV0Ly"),n=s("7Rjir");let a=(0,o.defineStore)("options",()=>{let e=new URLSearchParams(window.location.search),t=(e.get("tuio")??"true")==="true",r=(e.get("pointer")??"false")==="true",o=Number.parseInt(e.get("numPointerMarkers")??`${n.NUM_POINTER_MARKERS}`,10),a=e.get("tuioUrl")??"ws://localhost:3339",i=(e.get("autoStart")??"true")==="true";return{useTuioMarkers:t,usePointerMarkers:r,numPointerMarkers:o,tuioUrl:a,autoStart:i}})}),l("46h5Q",function(e,t){r(e.exports,"Tuio11EventEmitter",function(){return n});var o=s("3ZGF0");class n extends o.EventEmitter{addTuioObject(e){this.emit("tuio-object-add",e)}updateTuioObject(e){this.emit("tuio-object-update",e)}removeTuioObject(e){this.emit("tuio-object-remove",e)}addTuioCursor(e){this.emit("tuio-cursor-add",e)}updateTuioCursor(e){this.emit("tuio-cursor-update",e)}removeTuioCursor(e){this.emit("tuio-cursor-remove",e)}addTuioBlob(e){this.emit("tuio-blob-add",e)}updateTuioBlob(e){this.emit("tuio-blob-update",e)}removeTuioBlob(e){this.emit("tuio-blob-remove",e)}refresh(e){this.emit("refresh",e)}}}),l("h1KQv",function(e,t){r(e.exports,"WebsocketTuioReceiver",function(){return s("4IIOm").WebsocketTuioReceiver}),r(e.exports,"Tuio11Client",function(){return s("4Bz8r").Tuio11Client}),s("7oQXN"),s("4Bz8r"),s("4IIOm")}),l("7oQXN",function(e,t){r(e.exports,"WebsocketTuioReceiver",function(){return s("4IIOm").WebsocketTuioReceiver}),r(e.exports,"Tuio11Client",function(){return s("4Bz8r").Tuio11Client}),s("aepZW"),s("bNthR"),s("2SMZK"),s("bSOPx"),s("4IIOm"),s("2Cyxe"),s("4Bz8r"),s("cmRMF"),s("02co9"),s("b3X4E"),s("1lgn3");/* Exclude TUIO 2.0 code for now
// TUIO 2.0 code
import { Tuio20Bounds } from './tuio20/Tuio20Bounds.js';
import { Tuio20Client } from './tuio20/Tuio20Client.js';
import { Tuio20Component } from './tuio20/Tuio20Component.js';
import { Tuio20Object } from './tuio20/Tuio20Object.js';
import { Tuio20Point } from './tuio20/Tuio20Point.js';
import { Tuio20Pointer } from './tuio20/Tuio20Pointer.js';
import { Tuio20Symbol } from './tuio20/Tuio20Symbol.js';
import { Tuio20Token } from './tuio20/Tuio20Token.js';

export {
  Tuio20Bounds,
  Tuio20Client,
  Tuio20Component,
  Tuio20Object,
  Tuio20Point,
  Tuio20Pointer,
  Tuio20Symbol,
  Tuio20Token,
};
*/}),l("aepZW",function(e,t){class r{static UDP=new r("UDP");static Websocket=new r("Websocket");constructor(e){this.name=e}toString(){return`TuioConnectionType.${this.name}`}}}),l("bNthR",function(e,t){r(e.exports,"TuioReceiver",function(){return o});class o{constructor(){this._isConnected=!1,this._messageListeners={}}connect(){}disconnect(){}onOscMessage(e){let t=this._messageListeners[e.address];if(void 0!==t)for(let r of t)r(e)}addMessageListener(e,t){e in this._messageListeners||(this._messageListeners[e]=[]),this._messageListeners[e].push(t)}}}),l("2SMZK",function(e,t){r(e.exports,"TuioState",function(){return o});class o{static Added=new o("Added");static Accelerating=new o("Accelerating");static Decelerating=new o("Decelerating");static Stopped=new o("Stopped");static Removed=new o("Removed");static Rotating=new o("Rotating");static Idle=new o("Idle");constructor(e){this.name=e}toString(){return`TuioState.${this.name}`}}}),l("bSOPx",function(e,t){r(e.exports,"TuioTime",function(){return o});class o{static _startTime=new o(0,0);constructor(e,t){this._seconds=e,this._microSeconds=t}static fromOscTime(e){return new o(e.raw[0],e.raw[1]/4294967296)}subtract(e){let t=this._seconds-e._seconds,r=this._microSeconds-e._microSeconds;return r<0&&(r+=1e6,t-=1),new o(t,r)}getTotalMilliseconds(){return 1e3*this._seconds+this._microSeconds/1e3}static init(){o._startTime=o._getSystemTime()}static _getSystemTime(){let e=performance.now();return new o(Math.floor(e/1e3),Math.floor(1e3*e)%1e6)}static getCurrentTime(){return o._getSystemTime().subtract(o._startTime)}}}),l("4IIOm",function(e,t){r(e.exports,"WebsocketTuioReceiver",function(){return a});var o=s("9iGn8"),n=s("bNthR");class a extends n.TuioReceiver{constructor(e){super(),this._oscPort=new o.WebSocketPort({url:e,metadata:!0})}connect(){this._oscPort.open(),this._isConnected=!0,this._oscPort.on("message",(function(e){this.onOscMessage(e)}).bind(this))}disconnect(){this._oscPort.close(),this._isConnected=!1}}}),l("2Cyxe",function(e,t){r(e.exports,"Tuio11Blob",function(){return a});var o=s("cmRMF"),n=s("2SMZK");class a extends o.Tuio11Container{constructor(e,t,r,o,n,a,i,s,l,u,c,d,p,f){super(e,t,o,n,u,c,p),this._blobId=t,this._angle=a,this._width=i,this._height=s,this._area=l,this._rotationSpeed=d,this._rotationAccel=f}get blobId(){return this._blobId}get angle(){return this._angle}get width(){return this._angle}get height(){return this._angle}get area(){return this._angle}get rotationSpeed(){return this._rotationSpeed}get rotationAccel(){return this._rotationAccel}_hasChanged(e,t,r,o,n,a,i,s,l,u,c,d){return!(t===this.xPos&&r===this.yPos&&o===this.angle&&n===this.width&&a===this.height&&i===this.area&&s===this.xSpeed&&l===this.ySpeed&&u===this.rotationSpeed&&c===this.motionAccel&&d===this.rotationAccel)}_update(e,t,r,o,a,i,s,l,u,c,d,p){let f=this.path[this.path.length-1],m=t!==this.xPos&&0===l||r!==this.yPos&&0===u;if(this._updateContainer(e,t,r,l,u,d,m),o!==this.angle&&0===c){let t=e.subtract(f.startTime).getTotalMilliseconds()/1e3,r=this.angle,n=this.rotationSpeed,a=(o-r)/(2*Math.PI);a>.5?a-=1:a<=-.5&&(a+=1),this._rotationSpeed=a/t,this._rotationAccel=(this.rotationSpeed-n)/t}else this._rotationSpeed=c,this._rotationAccel=p;this._angle=o,this._state!==n.TuioState.Stopped&&0!==this.rotationAccel&&(this._state=n.TuioState.Rotating),this._width=a,this._height=i,this._area=s}}}),l("cmRMF",function(e,t){r(e.exports,"Tuio11Container",function(){return a});var o=s("1lgn3"),n=s("2SMZK");class a extends o.Tuio11Point{MAX_PATH_LENGTH=128;constructor(e,t,r,a,i,s,l){super(e,r,a),this._currentTime=e,this._sessionId=t,this._xSpeed=i,this._ySpeed=s,this._motionSpeed=Math.sqrt(i*i+s*s),this._motionAccel=l,this._state=n.TuioState.Added,this._prevPoints=[],this._prevPoints.push(new o.Tuio11Point(e,r,a))}get currentTime(){return this._currentTime}get sessionId(){return this._sessionId}get xSpeed(){return this._xSpeed}get ySpeed(){return this._ySpeed}get motionSpeed(){return this._motionSpeed}get motionAccel(){return this._motionAccel}get state(){return this._state}get path(){return this._prevPoints}_updateContainer(e,t,r,a,i,s,l){let u=this.path[this.path.length-1];if(this._xPos=t,this._yPos=r,l){let t=e.subtract(u.startTime).getTotalMilliseconds()/1e3,r=this.xPos-u.xPos,o=this.yPos-u.yPos,n=this.motionSpeed;this._xSpeed=r/t,this._ySpeed=o/t,this._motionSpeed=Math.sqrt(r*r+o*o)/t,this._motionAccel=(this.motionSpeed-n)/t}else this._xSpeed=a,this._ySpeed=i,this._motionSpeed=Math.sqrt(a*a+i*i),this._motionAccel=s;this._currentTime=e,this._prevPoints.push(new o.Tuio11Point(e,t,r)),this._prevPoints.length>this.MAX_PATH_LENGTH&&this._prevPoints.shift(),this._motionAccel>0?this._state=n.TuioState.Accelerating:this._motionAccel<0?this._state=n.TuioState.Decelerating:this._state=n.TuioState.Stopped}_remove(e){this._currentTime=e,this._state=n.TuioState.Removed}}}),l("1lgn3",function(e,t){r(e.exports,"Tuio11Point",function(){return o});class o{constructor(e,t,r){this._startTime=e,this._xPos=t,this._yPos=r}get startTime(){return this._startTime}get xPos(){return this._xPos}get yPos(){return this._yPos}}}),l("4Bz8r",function(e,t){r(e.exports,"Tuio11Client",function(){return l});var o=s("b3X4E"),n=s("02co9"),a=s("2Cyxe"),i=s("bSOPx");class l{constructor(e){this._tuioReceiver=e,this._tuioReceiver.addMessageListener("/tuio/2Dobj",this._on2Dobj.bind(this)),this._tuioReceiver.addMessageListener("/tuio/2Dcur",this._on2Dcur.bind(this)),this._tuioReceiver.addMessageListener("/tuio/2Dblb",this._on2Dblb.bind(this)),this._tuioListeners=[],this._tuioObjects=new Map,this._tuioCursors=new Map,this._tuioBlobs=new Map,this._objectSetMessages=[],this._cursorSetMessages=[],this._blobSetMessages=[],this._objectAliveMessage=null,this._cursorAliveMessage=null,this._blobAliveMessage=null,this._freeCursorIds=[],this._freeBlobIds=[],this._currentFrame=0,this._currentTime=null}connect(){(0,i.TuioTime).init(),this._currentTime=(0,i.TuioTime).getCurrentTime(),this._tuioReceiver.connect()}disconnect(){this._tuioReceiver.disconnect()}addTuioListener(e){this._tuioListeners.push(e)}removeTuioListener(e){let t=this._tuioListeners.indexOf(e);t>-1&&this._tuioListeners.splice(t,1)}removeAllTuioListeners(){this._tuioListeners=[]}getTuioObjects(){return this._tuioObjects.values()}getTuioCursors(){return this._tuioCursors.values()}getTuioBlobs(){return this._tuioBlobs.values()}getTuioObject(e){let t=this._tuioObjects.get(e);return void 0===t?null:t}getTuioCursor(e){let t=this._tuioCursors.get(e);return void 0===t?null:t}getTuioBlob(e){let t=this._tuioBlobs.get(e);return void 0===t?null:t}_updateFrame(e){let t=(0,i.TuioTime).getCurrentTime();if(e>0){if(e>this._currentFrame&&(this._currentTime=t),!(e>=this._currentFrame)&&!(this._currentFrame-e>100))return!1;this._currentFrame=e}else t.subtract(this._currentTime).getTotalMilliseconds()>100&&(this._currentTime=t);return!0}_on2Dobj(e){let t=e.args[0].value;if("set"===t)this._objectSetMessages.push(e);else if("alive"===t)this._objectAliveMessage=e;else if("fseq"===t){let t=e.args[1].value;if(this._updateFrame(t)){if(null!==this._objectAliveMessage){let e=new Set(this._tuioObjects.keys()),t=new Set(this._objectAliveMessage.args.slice(1).map(e=>e.value));for(let r of new Set([...e].filter(e=>!t.has(e)))){let e=this._tuioObjects.get(r);for(let t of(e._remove(this._currentTime),this._tuioListeners))t.removeTuioObject(e);this._tuioObjects.delete(r)}for(let r of this._objectSetMessages){let[,n,a,i,s,l,u,c,d,p,f]=r.args.map(e=>e.value);if(t.has(n)){if(e.has(n)){let e=this._tuioObjects.get(n);if(e._hasChanged(this._currentTime,i,s,l,u,c,d,p,f))for(let t of(e._update(this._currentTime,i,s,l,u,c,d,p,f),this._tuioListeners))t.updateTuioObject(e)}else{let e=new o.Tuio11Object(this._currentTime,n,a,i,s,l,u,c,d,p,f);for(let t of(this._tuioObjects.set(n,e),this._tuioListeners))t.addTuioObject(e)}}}for(let e of this._tuioListeners)e.refresh(this._currentTime)}this._objectSetMessages=[],this._objectAliveMessage=null}}}_on2Dcur(e){let t=e.args[0].value;if("set"===t)this._cursorSetMessages.push(e);else if("alive"===t)this._cursorAliveMessage=e;else if("fseq"===t){let t=e.args[1].value;if(this._updateFrame(t)){if(null!==this._cursorAliveMessage){let e=new Set(this._tuioCursors.keys()),t=new Set(this._cursorAliveMessage.args.slice(1).map(e=>e.value));for(let r of new Set([...e].filter(e=>!t.has(e)))){let e=this._tuioCursors.get(r);for(let t of(e._remove(this._currentTime),this._tuioListeners))t.removeTuioCursor(e);this._tuioCursors.delete(r),this._freeCursorIds.push(e.cursorId)}for(let r of(this._freeCursorIds.sort(),this._cursorSetMessages)){let[,o,a,i,s,l,u]=r.args.map(e=>e.value);if(t.has(o)){if(e.has(o)){let e=this._tuioCursors.get(o);if(e._hasChanged(this._currentTime,a,i,s,l,u))for(let t of(e._update(this._currentTime,a,i,s,l,u),this._tuioListeners))t.updateTuioCursor(e)}else{let e=this._tuioCursors.size;this._freeCursorIds.length>0&&(e=this._freeCursorIds[0],this._freeCursorIds.splice(0,1));let t=new n.Tuio11Cursor(this._currentTime,o,e,a,i,s,l,u);for(let e of(this._tuioCursors.set(o,t),this._tuioListeners))e.addTuioCursor(t)}}}for(let e of this._tuioListeners)e.refresh(this._currentTime)}this._cursorSetMessages=[],this._cursorAliveMessage=null}}}_on2Dblb(e){let t=e.args[0].value;if("set"===t)this._blobSetMessages.push(e);else if("alive"===t)this._blobAliveMessage=e;else if("fseq"===t){let t=e.args[1].value;if(this._updateFrame(t)){if(null!==this._blobAliveMessage){let e=new Set(this._tuioBlobs.keys()),t=new Set(this._blobAliveMessage.args.slice(1).map(e=>e.value));for(let r of new Set([...e].filter(e=>!t.has(e)))){let e=this._tuioBlobs.get(r);for(let t of(e._remove(this._currentTime),this._tuioListeners))t.removeTuioBlob(e);this._tuioBlobs.delete(r),this._freeBlobIds.push(e.blobId)}for(let r of(this._freeBlobIds.sort(),this._blobSetMessages)){let[,o,n,i,s,l,u,c,d,p,f,m,h]=r.args.map(e=>e.value);if(t.has(o)){if(e.has(o)){let e=this._tuioBlobs.get(o);if(e._hasChanged(this._currentTime,n,i,s,l,u,c,d,p,f,m,h))for(let t of(e._update(this._currentTime,n,i,s,l,u,c,d,p,f,m,h),this._tuioListeners))t.updateTuioBlob(e)}else{let e=this._tuioBlobs.size;this._freeBlobIds.length>0&&(e=this._freeBlobIds[0],this._freeBlobIds.splice(0,1));let t=new a.Tuio11Blob(this._currentTime,o,e,n,i,s,l,u,c,d,p,f,m,h);for(let e of(this._tuioBlobs.set(o,t),this._tuioListeners))e.addTuioBlob(t)}}}for(let e of this._tuioListeners)e.refresh(this._currentTime)}this._blobSetMessages=[],this._blobAliveMessage=null}}}}}),l("b3X4E",function(e,t){r(e.exports,"Tuio11Object",function(){return a});var o=s("cmRMF"),n=s("2SMZK");class a extends o.Tuio11Container{constructor(e,t,r,o,n,a,i,s,l,u,c){super(e,t,o,n,i,s,u),this._symbolId=r,this._angle=a,this._rotationSpeed=l,this._rotationAccel=c}get symbolId(){return this._symbolId}get angle(){return this._angle}get rotationSpeed(){return this._rotationSpeed}get rotationAccel(){return this._rotationAccel}_hasChanged(e,t,r,o,n,a,i,s,l){return!(t===this.xPos&&r===this.yPos&&o===this.angle&&n===this.xSpeed&&a===this.ySpeed&&i===this.rotationSpeed&&s===this.motionAccel&&l===this.rotationAccel)}_update(e,t,r,o,a,i,s,l,u){let c=this.path[this.path.length-1],d=t!==this.xPos&&0===a||r!==this.yPos&&0===i;if(this._updateContainer(e,t,r,a,i,l,d),o!==this.angle&&0===s){let t=e.subtract(c.startTime).getTotalMilliseconds()/1e3,r=this.angle,n=this.rotationSpeed,a=(o-r)/(2*Math.PI);a>.5?a-=1:a<=-.5&&(a+=1),this._rotationSpeed=a/t,this._rotationAccel=(this.rotationSpeed-n)/t}else this._rotationSpeed=s,this._rotationAccel=u;this._angle=o,this._state!==n.TuioState.Stopped&&0!==this.rotationAccel&&(this._state=n.TuioState.Rotating)}}}),l("02co9",function(e,t){r(e.exports,"Tuio11Cursor",function(){return n});var o=s("cmRMF");class n extends o.Tuio11Container{constructor(e,t,r,o,n,a,i,s){super(e,t,o,n,a,i,s),this._cursorId=r}get cursorId(){return this._cursorId}_hasChanged(e,t,r,o,n,a){return!(t===this.xPos&&r===this.yPos&&o===this.xSpeed&&n===this.ySpeed&&a===this.motionAccel)}_update(e,t,r,o,n,a){let i=t!==this.xPos&&0===o||r!==this.yPos&&0===n;this._updateContainer(e,t,r,o,n,a,i)}}}),l("dWDNN",function(e,t){r(e.exports,"render",function(){return a});var o=s("djimy");let n={ref:"container",class:"fill"};function a(e,t,r,a,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",n,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.pointerMarkers,e=>((0,o.openBlock)(),(0,o.createBlock)(a.MarkerUnderlay,{key:e.id,"marker-id":e.id,x:e.x,y:e.y,class:"marker-underlay",onPointerdown:t=>a.onPointerDown(t,e),onPointermove:t=>a.onPointerMove(t,e),onPointerup:t=>a.onPointerUpOrCancel(t,e),onPointercancel:t=>a.onPointerUpOrCancel(t,e)},null,8,["marker-id","x","y","onPointerdown","onPointermove","onPointerup","onPointercancel"]))),128))],512)}}),l("hfCe3",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("4I7K4",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("RDxjP")).__esModule&&(o=o.default),o.render=s("4bJi3").render,s("4OgPE").default(o),o.__scopeId="data-v-97f972",o.__file="TuioMarkerPanel.vue";var n=o}),l("RDxjP",function(e,o){t(e.exports),r(e.exports,"default",function(){return u});var n=s("djimy"),a=s("9OMm5"),i=s("dLTM2"),l=s("02fmQ"),u=/*#__PURE__*/(0,n.defineComponent)({__name:"TuioMarkerPanel",setup(e,{expose:t}){t();let{markerPositions:r}=(0,l.useMarkerStore)(),o=(0,a.useArrayFilter)(r,({id:e})=>e.startsWith("tuio-")),n={markerPositions:r,tuioMarkers:o,MarkerUnderlay:i.default};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}})}),l("4bJi3",function(e,t){r(e.exports,"render",function(){return a});var o=s("djimy");let n={ref:"container",class:"fill"};function a(e,t,r,a,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",n,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.tuioMarkers,e=>((0,o.openBlock)(),(0,o.createBlock)(a.MarkerUnderlay,{key:e.id,"marker-id":e.id,x:e.x,y:e.y},null,8,["marker-id","x","y"]))),128))],512)}}),l("4OgPE",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("2lug4",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("hv4TY")).__esModule&&(o=o.default),o.render=s("huuAb").render,s("2xYUZ").default(o),o.__scopeId="data-v-abfa3a",o.__file="ScoreItem.vue";var n=o}),l("hv4TY",function(e,o){t(e.exports),r(e.exports,"default",function(){return a});var n=s("djimy"),a=/*#__PURE__*/(0,n.defineComponent)({__name:"ScoreItem",props:{title:{},value:{}},setup(e,{expose:t}){t();let r=(0,n.computed)(()=>`${(100*e.value).toFixed(1)}%`),o={props:e,formattedValue:r};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}})}),l("huuAb",function(e,t){r(e.exports,"render",function(){return a});var o=s("djimy");let n={id:"user-satisfaction-container",class:"score"};function a(e,t,r,a,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",n,[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(r.title),1),(0,o.createTextVNode)(":\xa0 "),(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(a.formattedValue),1)])}}),l("2xYUZ",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("lbosM",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("4rVEm")).__esModule&&(o=o.default),o.render=s("hT9Bb").render,o.__cssModules={},s("9nPpA").default(o),o.__scopeId="data-v-d9018e",o.__file="ControlPanel.vue";var n=o}),l("4rVEm",function(e,o){t(e.exports),r(e.exports,"default",function(){return d});var n=s("djimy"),a=s("1jdKh"),i=s("iTpok"),l=s("3PxCe"),u=s("c1iJh"),c=s("d1qRQ"),d=/*#__PURE__*/(0,n.defineComponent)({__name:"ControlPanel",props:{disabled:Boolean},setup(e,{expose:t}){t();let r=(0,n.ref)(!0),o={props:e,diagramsTabDisabled:r,ControlPanelTabInitialParameters:a.default,ControlPanelTabParameterTransforms:i.default,ControlPanelTabCharts:l.default,ControlPanelTabImportExport:u.default,ControlPanelTabMisc:c.default};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}})}),l("1jdKh",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("6swzs")).__esModule&&(o=o.default),o.render=s("hqass").render,o.__cssModules={},s("HR4Xa").default(o),o.__scopeId="data-v-da743b",o.__file="ControlPanelTabInitialParameters.vue";var n=o}),l("6swzs",function(e,o){t(e.exports),r(e.exports,"default",function(){return c});var n=s("djimy"),a=s("kV0Ly"),i=s("9OMm5"),l=s("i5N9G"),u=s("aDsGb"),c=/*#__PURE__*/(0,n.defineComponent)({__name:"ControlPanelTabInitialParameters",setup(e,{expose:t}){t();let r=(0,l.useModelStore)(),o=(0,i.toReactive)((0,a.storeToRefs)(r).initialParameters),n={modelStore:r,initialParameters:o,get parameterIds(){return u.parameterIds}};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}})}),l("i5N9G",function(e,t){r(e.exports,"useModelStore",function(){return p});var o=s("hWymx"),n=s("kV0Ly"),a=s("djimy"),i=s("9OMm5"),l=s("aDsGb"),u=s("5rTuK"),c=s("cIjax");let d=e=>{let t=(0,c.useSlotGroupsStore)(),r=(0,u.useParameterTransformsStore)(),{slotGroups:n}=t,{parameterTransforms:a}=r,s=(0,i.reactiveComputed)(()=>{let t={...e.value},r=n.map(({id:e,parameterTransforms:r})=>{let n=r.map(({id:e,active:r})=>{let n=a.find(t=>t.id===e);(0,o.strict)(n,`No transform found for id ${e}`);let{script:i,transform:s}=n,l=r?s({...t}):{...t},u=Object.fromEntries(Object.entries(l).filter(([e,r])=>r!==t[e])),c={id:e,script:i,active:r,before:t,after:l,diff:u};return t={...l},c});return{id:e,steps:n}});return r}),l=(0,i.reactiveComputed)(()=>{let t=(e,t)=>e.length>0?e[e.length-1]:t,r=t(s.map(({steps:r})=>t(r.map(({after:e})=>e),e.value)),e.value);return r});return{transformedParametersExt:s,transformedParameters:l}},p=(0,n.defineStore)("model",()=>{let e=new(0,l.CircularEconomyModel)().evaluate(l.CircularEconomyModel.initialStocks,l.CircularEconomyModel.defaultParameters,0),t=(0,a.ref)(e),r=(0,a.ref)({...l.CircularEconomyModel.defaultParameters}),{transformedParameters:o,transformedParametersExt:n}=d(r);return{record:t,initialParameters:r,transformedParameters:o,transformedParametersExt:n}})}),l("aDsGb",function(e,t){r(e.exports,"stockIds",function(){return n}),r(e.exports,"flowIds",function(){return a}),r(e.exports,"variableIds",function(){return i}),r(e.exports,"parameterIds",function(){return l}),r(e.exports,"CircularEconomyModel",function(){return u});// This file was auto-generated from the InsightMaker model. Do not edit it manually.
var o=s("jRMUH");let n=["capacityOfNewlyProducedPhones","capacityOfRecycledMaterials","capacityOfRefurbishedPhones","capacityOfRepairedPhones","phonesInUse","supplyOfBrokenPhones","supplyOfDisposedPhones","supplyOfHibernatingPhones","supplyOfNewlyProducedPhones","supplyOfRecycledMaterials","supplyOfRefurbishedPhones","supplyOfRepairedPhones"],a=["abandon","acquireNewlyProduced","acquireRefurbished","acquireRepaired","acquireUsed","capacityOfNewlyProducedPhonesAdjustment","capacityOfRecycledMaterialsAdjustment","capacityOfRefurbishedPhonesAdjustment","disposeBroken","disposeHibernating","goBroken","landfill","produceFromNaturalResources","produceFromRecycledMaterials","recycle","refurbish","repair","repairShopCapcityAdjustment"],i=["demandForNaturalResources","demandForNewlyProducedPhones","demandForPhones","demandForRecycledMaterials","demandForRecycling","demandForRefurbishedPhones","demandForRefurbishment","demandForRepair","demandForRepairedPhones","demandForResources","demandForReusedPhones","inflowIncentiveSumForPhonesInUse","phoneGoal","phonesInUseExcess","supplyOfBrokenPhonesForDisposal","supplyOfBrokenPhonesForRepair","supplyOfDisposedPhonesForLandfilling","supplyOfDisposedPhonesForRecycling","supplyOfHibernatingPhonesForDisposal","supplyOfHibernatingPhonesForRefurbishment","supplyOfHibernatingPhonesForReuse"],l=["abandonExcessRate","abandonRate","acquireRate","breakRate","capacityAdjustmentRate","disposeIncentive","disposeRate","landfillIncentive","landfillRate","naturalResourcesIncentive","newPhoneProductionRate","newlyProducedPhoneIncentive","numberOfUsers","phonesPerUserGoal","recycleRate","recyclingIncentive","refurbishmentIncentive","refurbishmentRate","repairIncentive","repairRate","reuseIncentive"];class u extends o.Model{static #e=this.initialStocks={capacityOfNewlyProducedPhones:0,capacityOfRecycledMaterials:0,capacityOfRefurbishedPhones:0,capacityOfRepairedPhones:0,phonesInUse:0,supplyOfBrokenPhones:0,supplyOfDisposedPhones:0,supplyOfHibernatingPhones:0,supplyOfNewlyProducedPhones:0,supplyOfRecycledMaterials:0,supplyOfRefurbishedPhones:0,supplyOfRepairedPhones:0};static #t=this.defaultParameters={abandonExcessRate:.5,abandonRate:.1,acquireRate:1,breakRate:.1,capacityAdjustmentRate:.1,disposeIncentive:.5,disposeRate:.5,landfillIncentive:.5,landfillRate:1,naturalResourcesIncentive:.5,newPhoneProductionRate:.5,newlyProducedPhoneIncentive:.82,numberOfUsers:1e6,phonesPerUserGoal:1,recycleRate:1,recyclingIncentive:.89,refurbishmentIncentive:.5,refurbishmentRate:1,repairIncentive:.5,repairRate:1,reuseIncentive:.86};constructor(){super(n,a,i,l)}// eslint-disable-next-line class-methods-use-this
evaluate(e,t,r){let{capacityOfNewlyProducedPhones:o,capacityOfRecycledMaterials:n,capacityOfRefurbishedPhones:a,capacityOfRepairedPhones:i,phonesInUse:s,supplyOfBrokenPhones:l,supplyOfDisposedPhones:u,supplyOfHibernatingPhones:c,supplyOfNewlyProducedPhones:d,supplyOfRecycledMaterials:p,supplyOfRefurbishedPhones:f,supplyOfRepairedPhones:m}=e,{abandonExcessRate:h,abandonRate:g,acquireRate:b,breakRate:y,capacityAdjustmentRate:_,disposeIncentive:S,disposeRate:x,landfillIncentive:k,landfillRate:T,naturalResourcesIncentive:P,newPhoneProductionRate:C,newlyProducedPhoneIncentive:I,numberOfUsers:E,phonesPerUserGoal:M,recycleRate:w,recyclingIncentive:R,refurbishmentIncentive:O,refurbishmentRate:A,repairIncentive:N,repairRate:j,reuseIncentive:B}=t,F=E*M,G=Math.max(s-F,0),D=g*s+h*G,V=B+N+O+I,L=y*s,q=Math.max(0,F-s+L+D),U=I/V*q,H=b*Math.min(d,U),$=O/V*q,W=b*Math.min($,f),z=N/V*q,K=b*Math.min(z,m),Q=B/(B+O+S)*c,Z=B/V*q,J=Math.max(o-d+H,0),Y=R/(P+R)*J,X=S/(N+S)*l,ee=S/(B+O+S)*c,et=k/(R+k)*u,er=P/(P+R)*J,eo=C*Math.min(Y,p),en=R/(R+k)*u,ea=Math.max(n-p+eo,0),ei=O/(B+O+S)*c,es=Math.max(a-f+W,0),el=Math.max(i-m+K,0);return{t:r,stocks:e,parameters:t,variables:{demandForNaturalResources:er,demandForNewlyProducedPhones:U,demandForPhones:q,demandForRecycledMaterials:Y,demandForRecycling:ea,demandForRefurbishedPhones:$,demandForRefurbishment:es,demandForRepair:el,demandForRepairedPhones:z,demandForResources:J,demandForReusedPhones:Z,inflowIncentiveSumForPhonesInUse:V,phoneGoal:F,phonesInUseExcess:G,supplyOfBrokenPhonesForDisposal:X,supplyOfBrokenPhonesForRepair:N/(N+S)*l,supplyOfDisposedPhonesForLandfilling:et,supplyOfDisposedPhonesForRecycling:en,supplyOfHibernatingPhonesForDisposal:ee,supplyOfHibernatingPhonesForRefurbishment:ei,supplyOfHibernatingPhonesForReuse:Q},flows:{abandon:D,acquireNewlyProduced:H,acquireRefurbished:W,acquireRepaired:K,acquireUsed:b*Math.min(Q,Z),capacityOfNewlyProducedPhonesAdjustment:_*(U-o),capacityOfRecycledMaterialsAdjustment:_*(Y-n),capacityOfRefurbishedPhonesAdjustment:_*($-a),disposeBroken:x*X,disposeHibernating:x*ee,goBroken:L,landfill:T*et,produceFromNaturalResources:C*er,produceFromRecycledMaterials:eo,recycle:w*Math.min(en,ea),refurbish:A*Math.min(ei,es),repair:j*Math.min(l,el),repairShopCapcityAdjustment:_*(z-i)}}}// eslint-disable-next-line class-methods-use-this
accumulateFlowsPerStock(e){let{abandon:t,acquireNewlyProduced:r,acquireRefurbished:o,acquireRepaired:n,acquireUsed:a,capacityOfNewlyProducedPhonesAdjustment:i,capacityOfRecycledMaterialsAdjustment:s,capacityOfRefurbishedPhonesAdjustment:l,disposeBroken:u,disposeHibernating:c,goBroken:d,landfill:p,produceFromNaturalResources:f,produceFromRecycledMaterials:m,recycle:h,refurbish:g,repair:b,repairShopCapcityAdjustment:y}=e;return{capacityOfNewlyProducedPhones:i,capacityOfRecycledMaterials:s,capacityOfRefurbishedPhones:l,capacityOfRepairedPhones:y,phonesInUse:r+o+n+a-(t+d),supplyOfBrokenPhones:d-(u+b),supplyOfDisposedPhones:u+c-(p+h),supplyOfHibernatingPhones:t-(a+c+g),supplyOfNewlyProducedPhones:f+m-r,supplyOfRecycledMaterials:h-m,supplyOfRefurbishedPhones:g-o,supplyOfRepairedPhones:b-n}}}}),l("jRMUH",function(e,t){r(e.exports,"Model",function(){return n});var o=s("4E5XB");class n{static #e=this.elementIds=["stocks","parameters","variables","flows"];constructor(e,t,r,o){this.stockIds=e,this.flowIds=t,this.variableIds=r,this.parameterIds=o}static elementObjectToArray(e,t){return e.map(e=>t[e])}static arrayToElementObject(e,t){let r={};for(let o=0;o<e.length;o+=1){let n=e[o];r[n]=t[o]}return r}stocksToStockArray(e){return n.elementObjectToArray(this.stockIds,e)}stockArrayToStocks(e){return n.arrayToElementObject(this.stockIds,e)}flowsToFlowArray(e){return n.elementObjectToArray(this.flowIds,e)}flowArrayToFlows(e){return n.arrayToElementObject(this.flowIds,e)}variablesToVariableArray(e){return n.elementObjectToArray(this.variableIds,e)}variableArrayToVariables(e){return n.arrayToElementObject(this.variableIds,e)}parametersToParameterArray(e){return n.elementObjectToArray(this.parameterIds,e)}parameterArrayToParameters(e){return n.arrayToElementObject(this.parameterIds,e)}evaluateFlowPerStock(e,t,r){let{flows:o}=this.evaluate(e,t,r);return this.accumulateFlowsPerStock(o)}createFlowEvaluator(e){return(t,r)=>{let o=this.stockArrayToStocks(t),n=this.evaluateFlowPerStock(o,e,r),a=this.stocksToStockArray(n);return a}}step(e,t,r,n){let a=this.stocksToStockArray(e),i=(0,o.step)(a,t,r,n);return this.stockArrayToStocks(i)}}}),l("4E5XB",function(e,t){r(e.exports,"step",function(){return n});var o=s("3h2ov");function n(e,t,r,n,a,i){return"number"==typeof t?(0,o.step)(e,t,r,n,a):function(e,t,r,n,a,i){let s=[...t];return(0,o.step)(e,r,n,(e,t)=>t===r?s:a(e,t),i)}(e,t,r,n,a,i)}}),l("3h2ov",function(e,t){r(e.exports,"step",function(){return n}),r(e.exports,"converge",function(){return a});var o=s("555Ja");function n(e,t,r,n,a=o.rk4){return a(e,t,r,n)}function a(e,t,r,n,a,i=o.rk4){let s=0,{userdata:l,done:u}=a(e,t,void 0,0);if(!u){let o,c=t;do o=i(o??e,c,r,n),c+=r,s+=1,{userdata:l,done:u}=a(o,c,l,s);while(!u)}return l}}),l("555Ja",function(e,t){r(e.exports,"rk4",function(){return o});function o(e,t,r,o){let n=e.length,a=o(e,t),i=Array(n),s=r/2,l=r/6,u=t+s;for(let t=0;t<n;t+=1)i[t]=e[t]+s*a[t];let c=o(i,u);for(let t=0;t<n;t+=1)i[t]=e[t]+s*c[t];let d=o(i,u);for(let t=0;t<n;t+=1)i[t]=e[t]+r*d[t],d[t]+=c[t];c=o(i,t+r);for(let t=0;t<n;t+=1)i[t]=e[t]+l*(a[t]+c[t]+2*d[t]);return i}}),l("5rTuK",function(e,t){r(e.exports,"useParameterTransformsStore",function(){return c});var o=s("kV0Ly"),n=s("djimy"),a=s("aDsGb"),i=s("k6FcS"),l=s("7dQGn");function u({id:e,script:t}){let r=(0,n.ref)(t),o=(0,n.computed)(()=>(function(e,t){e.forEach(e=>{if(!(0,i.isVarName)(e))throw Error(`Parameter name '${e}' can not be used as a variable`)});// eslint-disable-next-line @typescript-eslint/no-implied-eval
    let r=Function(t).toString(),o=Function(`{ ${e.join(", ")} }`,`(${r})(); return { ${e.join(", ")} }`);return e=>{let t=o(e);return Object.assign(e,t),e}})(a.parameterIds,r.value));return{id:e,script:r,transform:o}}let c=(0,o.defineStore)("parameter-transforms",()=>{let{config:e}=(0,l.useConfigStore)(),t=(0,n.reactive)(e.parameterTransforms.map(e=>(0,n.reactive)(u(e))));return{parameterTransforms:t,addOrModify:(e,r)=>{let o=t.findIndex(t=>t.id===e);if(-1===o){let o=u({id:e,script:r});t.push((0,n.reactive)(o))}else t[o].script=r},move:(e,r)=>{let[o]=t.splice(e,1);t.splice(r,0,o)},remove:e=>{let r=t.findIndex(t=>t.id===e);-1!==r&&t.splice(r,1)},replaceAll:e=>{let r=e.map(e=>(0,n.reactive)(u(e)));t.splice(0,t.length,...r)}}})}),l("k6FcS",function(e,t){r(e.exports,"isVarName",function(){return o});function o(e){return"string"==typeof e&&e.trim()===e&&null!==e.match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)}}),l("7dQGn",function(e,t){r(e.exports,"useConfigStore",function(){return l});var o=s("hWymx"),n=s("kV0Ly"),a=s("djimy"),i=s("7Rjir");let l=(0,n.defineStore)("config",()=>{let e=(0,a.inject)(i.CONFIG_INJECTION_KEY,null);(0,o.strict)(e);let{general:{assetBaseDir:t}}=e,r=new URL(`${t}/`,window.location.href),n=/_x([+-]?[0-9]+)_y([+-]?[0-9]+)\.[a-zA-Z0-9]+$/,s=e=>{if("string"!=typeof e)return s(e.href);let t=e.match(n);if(null===t||3!==t.length)return{x:0,y:0};let r=Number.parseInt(t[1],10),o=Number.parseInt(t[2],10);return{x:r,y:o}};return{config:e,assetBaseUrl:r,toAssetUrl:e=>new URL(e,r),extractAssetPosition:s}})}),l("cIjax",function(e,t){r(e.exports,"useParameterTransformId",function(){return c}),r(e.exports,"useSlotGroupsStore",function(){return f});var o=s("kV0Ly"),n=s("djimy"),a=s("gK2p2"),i=s("7dQGn"),l=s("5rTuK"),u=s("6clsW");function c(e){let t=(0,a.default)();return(0,n.reactive)({id:e,uuid:t,active:!1})}function d(){let e=(0,l.useParameterTransformsStore)(),t=(0,n.reactive)(e.parameterTransforms.map(({id:e})=>c(e)));return{id:"internal",parameterTransforms:t}}function p(e){let{type:t}=e;switch(t){case"basic":return function(e){let{id:t}=e,r=(0,n.reactive)(e.parameterTransformIds.map(c));return{id:t,parameterTransforms:r}}(e);case"action-card":return function(e){let{id:t}=e,r=(0,n.reactive)(e.cards.map(({parameterTransformId:e})=>c(e)));return{id:t,parameterTransforms:r}}(e);case"event-card":return function(e){let{id:t}=e,r=(0,n.reactive)(e.cards.map(({parameterTransformId:e})=>c(e)));return{id:t,parameterTransforms:r}}(e);default:return(0,u.exhaustiveGuard)(t)}}let f=(0,o.defineStore)("slot-groups",()=>{let{config:e}=(0,i.useConfigStore)(),t=d(),r=e.interaction.slotGroups.map(p),o=[t,...r];return{slotGroups:o,internalSlotGroup:t,nonInternalSlotGroups:r,rebuildInternalSlotGroup:()=>{t.parameterTransforms.splice(0,t.parameterTransforms.length,...d().parameterTransforms)}}})}),l("6clsW",function(e,t){r(e.exports,"exhaustiveGuard",function(){return o});function o(e){throw Error(`Reached forbidden guard function with unexpected value: ${JSON.stringify(e)}`)}}),l("hqass",function(e,t){r(e.exports,"render",function(){return a});var o=s("djimy");let n=["onUpdate:modelValue"];function a(e,t,r,a,i,s){return(0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.parameterIds,e=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:e},[(0,o.createElementVNode)("div",null,(0,o.toDisplayString)(e)+" = "+(0,o.toDisplayString)(a.initialParameters[e]),1),(0,o.withDirectives)((0,o.createElementVNode)("input",{type:"range",min:"0",max:"4",step:"0.001","onUpdate:modelValue":t=>a.initialParameters[e]=t},null,8,n),[[o.vModelText,a.initialParameters[e],void 0,{number:!0}]])]))),128)}}),l("HR4Xa",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("iTpok",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("2eFwL")).__esModule&&(o=o.default),o.render=s("f0bUl").render,o.__cssModules={},s("4Of6y").default(o),o.__scopeId="data-v-6a09f7",o.__file="ControlPanelTabParameterTransforms.vue";var n=o}),l("2eFwL",function(e,o){t(e.exports),r(e.exports,"default",function(){return d});var n=s("djimy"),a=s("hWymx"),i=s("aWxmM"),l=s("i5N9G"),u=s("5rTuK"),c=s("cIjax"),d=/*#__PURE__*/(0,n.defineComponent)({__name:"ControlPanelTabParameterTransforms",setup(e,{expose:t}){t();let{transformedParametersExt:r}=(0,l.useModelStore)(),o=(0,u.useParameterTransformsStore)(),{slotGroups:s,nonInternalSlotGroups:d,internalSlotGroup:p}=(0,c.useSlotGroupsStore)(),f=(0,n.ref)(""),m=(0,n.ref)("");function h(e,t){o.move(e,t)}let g=(0,n.ref)(null);(0,n.onMounted)(()=>{(0,a.strict)(g.value),(0,i.default).create(g.value,{onEnd:e=>{let{newDraggableIndex:t,oldDraggableIndex:r}=e;(0,a.strict)(void 0!==t),(0,a.strict)(void 0!==r),h(r,t)}})});let b={transformedParametersExt:r,parameterTransformsStore:o,slotGroups:s,nonInternalSlotGroups:d,internalSlotGroup:p,newId:f,newScript:m,select:function({id:e}){f.value=e,m.value=o.parameterTransforms.find(t=>t.id===e)?.script??""},addOrModify:function(e,t){o.addOrModify(e,t);let r=p.parameterTransforms.findIndex(t=>t.id===e);if(-1===r){// The parameter transform is not yet in the internal slot group, so we add it
let t=(0,c.useParameterTransformId)(e);p.parameterTransforms.push(t)}},remove:function(e){let t=-1!==d.flatMap(({parameterTransforms:e})=>e).findIndex(t=>t.id===e);if(t){alert("Cannot remove parameter transform that is still used in a non-internal slot group");return}let r=()=>p.parameterTransforms.findIndex(t=>t.id===e);for(let e=r();-1!==e;e=r())p.parameterTransforms.splice(e,1);o.remove(e)},move:h,deactivateAllInternal:function(){p.parameterTransforms.forEach(e=>{// eslint-disable-next-line no-param-reassign
e.active=!1})},createTooltip:(e,t)=>{let o=s.findIndex(t=>t===e);(0,a.strict)(-1!==o);let n=r[o],i=e.parameterTransforms.findIndex(e=>e===t);(0,a.strict)(-1!==i);let l=n.steps[i],{active:u,script:c,diff:d}=l;return u?`Diff: ${JSON.stringify(d,null,2)}

Script:
${c}`:`Script:
${c}`},availableContainer:g};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}})}),l("f0bUl",function(e,t){r(e.exports,"render",function(){return P});var o=s("djimy");let n={id:"parameter-transforms",class:"parameter-transforms"},a={ref:"availableContainer",class:"available"},i=["id","data-id","title"],l={class:"draggable"},u=["value","onUpdate:modelValue"],c={class:"draggable"},d=["onClick"],p=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),f=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),m=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),h=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),g=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),b={class:"slot-group-transforms"},y=["data-id"],_=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),S={class:"available"},x=["data-id","title"],k=["value","onUpdate:modelValue"],T=["onClick"];function P(e,t,r,s,P,C){return(0,o.openBlock)(),(0,o.createElementBlock)("div",n,[(0,o.createElementVNode)("div",null,[(0,o.createTextVNode)(" Internal (applied first): "),(0,o.createElementVNode)("div",a,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.internalSlotGroup.parameterTransforms,e=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"parameter-transform",key:e.uuid,id:e.uuid,"data-id":e.id,title:s.createTooltip(s.internalSlotGroup,e)},[(0,o.createElementVNode)("label",l,[(0,o.withDirectives)((0,o.createElementVNode)("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t=>e.active=t},null,8,u),[[o.vModelCheckbox,e.active]]),(0,o.createElementVNode)("span",c,(0,o.toDisplayString)(e.id),1)]),(0,o.createElementVNode)("span",{class:"edit",onClick:t=>s.select(e)},"✎",8,d)],8,i))),128))],512),p,(0,o.createElementVNode)("input",{type:"button",value:"Deactivate active internal transforms",onClick:t[0]||(t[0]=e=>s.deactivateAllInternal())})]),(0,o.createElementVNode)("div",null,[(0,o.createElementVNode)("div",null,[(0,o.createTextVNode)(" Id:"),f,(0,o.withDirectives)((0,o.createElementVNode)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>s.newId=e),name:"parameter-transform-id"},null,512),[[o.vModelText,s.newId]]),m,(0,o.createTextVNode)(" Script:"),h,(0,o.withDirectives)((0,o.createElementVNode)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.newScript=e),rows:"5",cols:"10",name:"parameter-transform-script"},null,512),[[o.vModelText,s.newScript]]),g,(0,o.createElementVNode)("input",{type:"button",value:"Add/Modify",onClick:t[3]||(t[3]=e=>s.addOrModify(s.newId,s.newScript))}),(0,o.createElementVNode)("input",{type:"button",value:"Delete",onClick:t[4]||(t[4]=e=>s.remove(s.newId))})]),(0,o.createElementVNode)("div",b,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.nonInternalSlotGroups,e=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:e.id,"data-id":e.id},[_,(0,o.createTextVNode)(" Slot group '"+(0,o.toDisplayString)(e.id)+"': ",1),(0,o.createElementVNode)("div",S,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.parameterTransforms,t=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t.uuid,"data-id":t.id,title:s.createTooltip(e,t)},[(0,o.createElementVNode)("label",null,[(0,o.withDirectives)((0,o.createElementVNode)("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e=>t.active=e,disabled:""},null,8,k),[[o.vModelCheckbox,t.active]]),(0,o.createTextVNode)((0,o.toDisplayString)(t.id),1)]),(0,o.createElementVNode)("span",{class:"edit",onClick:e=>s.select(t)},"✎",8,T)],8,x))),128))])],8,y))),128))])])])}}),l("4Of6y",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("3PxCe",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("4KeeH")).__esModule&&(o=o.default),o.render=s("fqpjM").render,s("aJLcO").default(o),o.__scopeId="data-v-ff532a",o.__file="ControlPanelTabCharts.vue";var n=o}),l("4KeeH",function(e,o){t(e.exports),r(e.exports,"default",function(){return c});var n=s("djimy"),a=s("hWymx"),i=s("dbRyT"),l=s("i5N9G"),u=s("aDsGb"),c=/*#__PURE__*/(0,n.defineComponent)({__name:"ControlPanelTabCharts",props:{disabled:Boolean},setup(e,{expose:t}){function r(e){return(0,u.CircularEconomyModel).elementIds.map(t=>Object.entries(e[t]).map(([e,t])=>({id:e,value:t}))).reduce((e,t)=>[...e,...t],[])}t(),(0,i.Chart).register(i.BarController,i.Title,i.Tooltip,i.Legend,i.BarElement,i.CategoryScale,i.LinearScale);let o=(0,l.useModelStore)(),s={stocks:u.stockIds,flows:u.flowIds,variables:u.variableIds,parameters:u.parameterIds},c=Object.values(s).flat(),d=(0,n.ref)(null);(0,n.onMounted)(()=>{(0,a.strict)(d.value);let t=new i.Chart(d.value,{type:"bar",data:{labels:c,datasets:[{label:"Values",data:Array(c.length).fill(0)}]},options:{animation:!1}});(0,n.watchEffect)(()=>{if(e.disabled)return;let n=r(o.record);t.data.datasets[0].data=n.map(e=>e.value),t.update()})});let p={props:e,toChartJsRecord:r,modelStore:o,labels:s,labelsArray:c,canvas:d};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}})}),l("fqpjM",function(e,t){r(e.exports,"render",function(){return i});var o=s("djimy");let n={style:{width:"100%"}},a={ref:"canvas"};function i(e,t,r,i,s,l){return(0,o.openBlock)(),(0,o.createElementBlock)("div",n,[(0,o.createElementVNode)("canvas",a,null,512)])}}),l("aJLcO",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("c1iJh",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("jVwA8")).__esModule&&(o=o.default),o.render=s("gpQtt").render,s("dtadU").default(o),o.__scopeId="data-v-ebdacf",o.__file="ControlPanelTabImportExport.vue";var n=o}),l("jVwA8",function(e,o){t(e.exports),r(e.exports,"default",function(){return d});var n=s("djimy"),a=s("jTevu"),i=s("5rTuK"),l=s("cIjax"),u=s("7dQGn"),c=s("krAM6"),d=/*#__PURE__*/(0,n.defineComponent)({__name:"ControlPanelTabImportExport",setup(e,{expose:t}){t();let{config:r}=(0,u.useConfigStore)(),o=(0,i.useParameterTransformsStore)(),{parameterTransforms:s}=o,{rebuildInternalSlotGroup:d}=(0,l.useSlotGroupsStore)(),p=(0,n.ref)(""),f={config:r,parameterTransformsStore:o,parameterTransforms:s,rebuildInternalSlotGroup:d,yamlText:p,importParameterTransforms:function(){let e=(0,a.default).load(p.value),t=structuredClone((0,n.toRaw)(r));t.parameterTransforms=e.parameterTransforms;let i=(0,c.validateConfig)(t);if(!i.ok){/* eslint-disable no-console */let{error:{errors:e,explanation:r}}=i;console.error("Invalid configuration:",t),console.error(r),console.error("Issues reported by the configuration validator:",...e??[]);return}let{parameterTransforms:s}=i.data;o.replaceAll(s),d()},exportParameterTransforms:function(){let e={parameterTransforms:s.map(({id:e,script:t})=>({id:e,script:t}))};p.value=(0,a.default).dump(e),console.log(p.value)}};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}})}),l("krAM6",function(e,t){r(e.exports,"validateConfig",function(){return l});var o=s("Clc2s"),n=s("ke2S4");s("bepfO");let a=n.SuretypeConfigSchema,i=(0,o.compile)(a);(0,o.compile)(a,{ensure:!0}),(0,o.compile)(a,{simple:!0});let l=e=>{let t=i(e);if(!t.ok){let{errors:e,explanation:r}=t;return{ok:!1,error:{errors:e,explanation:r}}}return{ok:!0,data:e}}}),l("ke2S4",function(e,t){r(e.exports,"SuretypeConfigSchema",function(){return x});var o=s("Clc2s"),n=s("aDsGb");let a=(0,o.v).string().matches(/_x[+-]?[0-9]+_y[+-]?[0-9]+\.[a-zA-Z0-9]+$/g),i=(0,o.suretype)({name:"ParameterTransformConfig"},(0,o.v).object({id:(0,o.v).string().required(),script:(0,o.v).string().required()}).additional(!1).required()),l=(0,o.v).array(i),u=(0,o.suretype)({name:"InitialParametersConfig"},(0,o.v).object(Object.fromEntries((0,n.parameterIds).map(e=>[e,(0,o.v).number().required()]))).additional(!1)),c=(0,o.suretype)({name:"InitialStocksConfig"},(0,o.v).object(Object.fromEntries((0,n.stockIds).map(e=>[e,(0,o.v).number().required()]))).additional(!1)),d=(0,o.suretype)({name:"MarkerSlotConfig"},(0,o.v).object({id:(0,o.v).string().required(),x:(0,o.v).number().required(),y:(0,o.v).number().required(),angle:(0,o.v).number().default(0)}).additional(!1)),p=(0,o.suretype)({name:"CardSlotConfig"},(0,o.v).object({id:(0,o.v).string().required(),x:(0,o.v).number().required(),y:(0,o.v).number().required(),angle:(0,o.v).number().default(0).required()}).additional(!1)),f=(0,o.suretype)({name:"CardConfig"},(0,o.v).object({parameterTransformId:(0,o.v).string().required(),url:a.required()}).additional(!1)),m=(0,o.v).string().matches(/^((?!internal).)*$/g),h=(0,o.suretype)({name:"BasicSlotGroupConfig"},(0,o.v).object({id:m.required(),type:(0,o.v).string().enum("basic").required(),slots:(0,o.v).array(d).required(),parameterTransformIds:(0,o.v).array((0,o.v).string()).required()}).additional(!1)),g=(0,o.suretype)({name:"ActionCardSlotGroupConfig"},(0,o.v).object({id:m.required(),type:(0,o.v).string().enum("action-card").required(),slots:(0,o.v).array((0,o.v).object({markerSlot:d.required(),cardSlot:p.required()}).additional(!1)).required(),cards:(0,o.v).array(f).required()}).additional(!1)),b=(0,o.suretype)({name:"EventCardSlotGroupConfig"},(0,o.v).object({id:m.required(),minDelayMs:(0,o.v).number().gte(0).required(),maxDelayMs:(0,o.v).number().gte(0).required(),minDurationMs:(0,o.v).number().gte(0).required(),maxDurationMs:(0,o.v).number().gte(0).required(),type:(0,o.v).string().enum("event-card").required(),markerSlot:d.required(),cardSlots:(0,o.v).array(p).required(),cards:(0,o.v).array(f).required()}).additional(!1)),y=(0,o.suretype)({name:"SlotGroup"},(0,o.v).anyOf([h,g,b])),_=(0,o.suretype)({name:"TriggerConditionConfig"},(0,o.v).object({condition:(0,o.v).string().required(),url:a.required()}).additional(!1).required()),S=(0,o.suretype)({name:"TriggerConfig"},(0,o.v).object({id:(0,o.v).string().required(),events:(0,o.v).array(_).required()}).additional(!1).required()),x=(0,o.suretype)({name:"Config"},(0,o.v).object({general:(0,o.v).object({assetBaseDir:(0,o.v).string().required()}).additional(!1).required(),model:(0,o.v).object({initialParameters:u.required(),initialStocks:c.required()}).additional(!1).required(),simulation:(0,o.v).object({deltaPerSecond:(0,o.v).number().required(),maxStepSize:(0,o.v).number().required()}).additional(!1).required(),parameterTransforms:l.required(),interaction:(0,o.v).object({slotActivationDelay:(0,o.v).number().required(),slotDeactivationDelay:(0,o.v).number().required(),slotGroups:(0,o.v).array(y).required()}).additional(!1).required(),triggers:(0,o.v).array(S).required()}).additional(!1).required())}),l("bepfO",function(e,t){s("cbFbI")}),l("cbFbI",function(e,t){/* tslint:disable *//* eslint-disable *//**
 * This file is generated by core-types-ts on behalf of typeconv, DO NOT EDIT.
 * For more information, see:
 *  - {@link https://github.com/grantila/core-types-ts}
 *  - {@link https://github.com/grantila/typeconv}
 */}),l("gpQtt",function(e,t){r(e.exports,"render",function(){return a});var o=s("djimy");let n=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1);function a(e,t,r,a,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createTextVNode)(" Import/Export parameter transforms:"),n,(0,o.withDirectives)((0,o.createElementVNode)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.yamlText=e),rows:"37",cols:"80"},null,512),[[o.vModelText,a.yamlText]]),(0,o.createElementVNode)("div",null,[(0,o.createElementVNode)("input",{type:"button",value:"Import",onClick:t[1]||(t[1]=e=>a.importParameterTransforms())}),(0,o.createElementVNode)("input",{type:"button",value:"Export",onClick:t[2]||(t[2]=e=>a.exportParameterTransforms())})])],64)}}),l("dtadU",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("d1qRQ",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("e1eyS")).__esModule&&(o=o.default),o.render=s("5Fgja").render,s("kdosU").default(o),o.__scopeId="data-v-b3789f",o.__file="ControlPanelTabMisc.vue";var n=o}),l("e1eyS",function(e,o){t(e.exports),r(e.exports,"default",function(){return l});var n=s("djimy"),a=s("gK2p2"),i=s("f4LB1"),l=/*#__PURE__*/(0,n.defineComponent)({__name:"ControlPanelTabMisc",setup(e,{expose:t}){t();let r=`btn-toggle-playing-${(0,a.default)()}`,o=`btn-toggle-playing-${(0,a.default)()}`,n=(0,i.useAppStore)(),s={togglePlayingBtnId:r,toggleFullscreenBtnId:o,appStore:n,togglePlaying:()=>n.$patch({isPlaying:!n.isPlaying}),toggleFullscreen:()=>n.$patch({isFullscreen:!n.isFullscreen})};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}})}),l("f4LB1",function(e,t){r(e.exports,"useAppStore",function(){return i});var o=s("kV0Ly"),n=s("djimy"),a=s("flGFW");let i=(0,o.defineStore)("app",()=>{let{autoStart:e}=(0,a.useOptionStore)(),t=(0,n.ref)(e),r=(0,n.ref)(!1);return{isPlaying:t,isFullscreen:r}})}),l("5Fgja",function(e,t){r(e.exports,"render",function(){return n});var o=s("djimy");function n(e,t,r,n,a,i){return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createElementVNode)("input",{type:"checkbox",class:(0,o.normalizeClass)(["btn-check",()=>n.appStore.isFullscreen?"active":""]),id:n.togglePlayingBtnId,autocomplete:"off",onClick:n.togglePlaying},null,2),(0,o.createElementVNode)("label",{class:"btn btn-primary",for:n.togglePlayingBtnId},"Run"),(0,o.createElementVNode)("input",{type:"checkbox",class:(0,o.normalizeClass)(["btn-check",()=>n.appStore.isFullscreen?"active":""]),id:n.toggleFullscreenBtnId,autocomplete:"off"},null,2),(0,o.createElementVNode)("label",{class:"btn btn-primary",for:n.toggleFullscreenBtnId,onClick:n.toggleFullscreen},"Fullscreen")],64)}}),l("kdosU",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("hT9Bb",function(e,t){r(e.exports,"render",function(){return b});var o=s("djimy");let n=e=>((0,o.pushScopeId)("data-v-d9018e"),e=e(),(0,o.popScopeId)(),e),a={class:"nav nav-tabs",id:"nav-tab",role:"tablist"},i=/*#__PURE__*/n(()=>/*#__PURE__*/(0,o.createElementVNode)("button",{class:"nav-link",id:"nav-initial-parameters-tab","data-bs-toggle":"tab","data-bs-target":"#nav-initial-parameters",type:"button",role:"tab","aria-controls":"nav-initial-parameters","aria-selected":"false"}," Initial parameters ",-1)),l=/*#__PURE__*/n(()=>/*#__PURE__*/(0,o.createElementVNode)("button",{class:"nav-link active",id:"nav-parameter-transforms-tab","data-bs-toggle":"tab","data-bs-target":"#nav-parameter-transforms",type:"button",role:"tab","aria-controls":"nav-parameter-transforms","aria-selected":"true"}," Parameter transforms ",-1)),u=/*#__PURE__*/n(()=>/*#__PURE__*/(0,o.createElementVNode)("button",{class:"nav-link",id:"nav-import-export-tab","data-bs-toggle":"tab","data-bs-target":"#nav-import-export",type:"button",role:"tab","aria-controls":"nav-import-export","aria-selected":"false"}," Import/Export ",-1)),c=/*#__PURE__*/n(()=>/*#__PURE__*/(0,o.createElementVNode)("button",{class:"nav-link",id:"nav-misc-tab","data-bs-toggle":"tab","data-bs-target":"#nav-misc",type:"button",role:"tab","aria-controls":"nav-misc","aria-selected":"true"}," Misc ",-1)),d={class:"tab-content",id:"nav-tabContent"},p={class:"tab-pane show",id:"nav-initial-parameters",role:"tabpanel","aria-labelledby":"nav-initial-parameters-tab",tabindex:"0"},f={class:"tab-pane show active",id:"nav-parameter-transforms",role:"tabpanel","aria-labelledby":"nav-parameter-transforms-tab",tabindex:"0"},m={class:"tab-pane show",id:"nav-diagrams",role:"tabpanel","aria-labelledby":"nav-diagrams-tab",tabindex:"0"},h={class:"tab-pane show",id:"nav-import-export",role:"tabpanel","aria-labelledby":"nav-import-export-tab",tabindex:"0"},g={class:"tab-pane show",id:"nav-misc",role:"tabpanel","aria-labelledby":"nav-misc-tab",tabindex:"0"};function b(e,t,r,n,s,b){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:(0,o.normalizeClass)(["control-panel",{hidden:n.props.disabled}])},[(0,o.createElementVNode)("nav",null,[(0,o.createElementVNode)("div",a,[i,l,(0,o.createElementVNode)("button",(0,o.mergeProps)({class:"nav-link",id:"nav-diagrams-tab","data-bs-toggle":"tab","data-bs-target":"#nav-diagrams",type:"button",role:"tab","aria-controls":"nav-diagrams","aria-selected":"false"},(0,o.toHandlers)({"hidden.bs.tab":()=>n.diagramsTabDisabled=!0,"show.bs.tab":()=>n.diagramsTabDisabled=!1},!0))," Diagrams ",16),u,c])]),(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(n.ControlPanelTabInitialParameters)]),(0,o.createElementVNode)("div",f,[(0,o.createVNode)(n.ControlPanelTabParameterTransforms)]),(0,o.createElementVNode)("div",m,[(0,o.createVNode)(n.ControlPanelTabCharts,{disabled:n.props.disabled||n.diagramsTabDisabled},null,8,["disabled"])]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(n.ControlPanelTabImportExport)]),(0,o.createElementVNode)("div",g,[(0,o.createVNode)(n.ControlPanelTabMisc)])])],2)}}),l("9nPpA",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("4fF5a",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("bONp9")).__esModule&&(o=o.default),o.render=s("cZI5q").render,o.__cssModules={},s("axaHd").default(o),o.__scopeId="data-v-b56a24",o.__file="TriggeredOverlay.vue";var n=o}),l("bONp9",function(e,o){t(e.exports),r(e.exports,"default",function(){return u});var n=s("djimy"),a=s("7dQGn"),i=s("i5N9G"),l=s("aDsGb"),u=/*#__PURE__*/(0,n.defineComponent)({__name:"TriggeredOverlay",props:{triggerConfig:{}},setup(e,{expose:t}){t();let{triggerConfig:r}=e,{events:o}=r,{extractAssetPosition:n,toAssetUrl:s}=(0,a.useConfigStore)(),{record:u}=(0,i.useModelStore)(),c=`{ ${(0,l.CircularEconomyModel).elementIds.join(", ")} }`;function d(e){// eslint-disable-next-line @typescript-eslint/no-implied-eval
return Function(c,`return (${e}) === true;`)}let p=o.map(({condition:e,url:t})=>{let r=s(t),{x:o,y:a}=n(r),i=d(e);return{checkCondition:i,condition:e,url:r,x:o,y:a}}),f={props:e,triggerConfig:r,events:o,extractAssetPosition:n,toAssetUrl:s,record:u,conditionParameters:c,compile:d,compiledEvents:p};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}})}),l("cZI5q",function(e,t){r(e.exports,"render",function(){return n});var o=s("djimy");function n(e,t,r,n,a,i){return(0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.compiledEvents,({condition:e,checkCondition:t,url:r,x:a,y:i})=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:`(${e})-(${r})`,style:(0,o.normalizeStyle)({backgroundImage:`url(${r.href})`,display:t(n.record)?"block":"none","--overlay-x":a,"--overlay-y":i}),class:"fill overlay-background"},null,4))),128)}}),l("axaHd",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("2vvax",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("eXrNq")).__esModule&&(o=o.default),o.render=s("jtxJg").render,s("eESbR").default(o),o.__scopeId="data-v-abe3e6",o.__file="BasicSlotGroup.vue";var n=o}),l("eXrNq",function(e,o){t(e.exports),r(e.exports,"default",function(){return u});var n=s("djimy"),a=s("hWymx"),i=s("cIjax"),l=s("jH98U"),u=/*#__PURE__*/(0,n.defineComponent)({__name:"BasicSlotGroup",props:{slotGroupConfig:{}},setup(e,{expose:t}){t();let{slotGroupConfig:r}=e,{slotGroups:o}=(0,i.useSlotGroupsStore)(),s=o.find(({id:e})=>e===r.id);(0,a.strict)(void 0!==s);let u=(0,n.ref)(0);(0,n.watchEffect)(()=>{s.parameterTransforms.forEach((e,t)=>{let r=u.value>t;e.active!==r&&(e.active=r)})});let c={props:e,slotGroupConfig:r,slotGroups:o,slotGroup:s,numActive:u,MarkerSlot:l.default};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}})}),l("jH98U",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("zgn46")).__esModule&&(o=o.default),o.render=s("gbmju").render,o.__cssModules={},s("65t20").default(o),o.__scopeId="data-v-0e606c",o.__file="MarkerSlot.vue";var n=o}),l("zgn46",function(e,o){t(e.exports),r(e.exports,"default",function(){return p});var n=s("djimy"),a=s("iNn5Y"),i=s("9OMm5"),l=s("7Rjir"),u=s("02fmQ"),c=s("fPRSg"),d=s("9QUOw"),p=/*#__PURE__*/(0,n.defineComponent)({__name:"MarkerSlot",props:{slotGroupId:{},slotConfig:{}},emits:["activate","deactivate"],setup(e,{expose:t,emit:r}){t();let{slotConfig:o}=e,s=(0,n.ref)(e.slotGroupId),p=`${s.value}-${o.id}`,f=(0,u.useMarkerStore)(),{markerPositions:m}=f,h=(0,c.useSlotStore)(),g=new d.Circle(o.x,o.y,l.SLOT_CIRCLE_DIAMETER/2),b=[],y=(0,i.useArrayFilter)(m,e=>g.containsPoint(e));(0,n.watchEffect)(()=>{let e=(0,a.difference)(y.value,b),t=(0,a.difference)(b,y.value);t.forEach(({id:e})=>h.addActivation({slotId:p,markerId:e})),e.forEach(({id:e})=>h.addActivation({slotId:p,markerId:e})),b=y.value});let _=(0,n.computed)(()=>y.value.length>0);(0,n.watch)(()=>_.value,(e,t)=>{e&&!t?r("activate",{slotId:p,slotGroupId:s.value}):r("deactivate",{slotId:p,slotGroupId:s.value})});let S={props:e,slotConfig:o,slotGroupId:s,slotId:p,markerStore:f,markerPositions:m,slotStore:h,slotCircle:g,get previousContainedMarkers(){return b},set previousContainedMarkers(v){b=v},containedMarkers:y,isActive:_,emit:r,get SLOT_CIRCLE_DIAMETER(){return l.SLOT_CIRCLE_DIAMETER}};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}})}),l("fPRSg",function(e,t){r(e.exports,"useSlotStore",function(){return a});var o=s("kV0Ly"),n=s("djimy");let a=(0,o.defineStore)("slot",()=>{let e=(0,n.ref)([]),t=t=>{let r=e.value.findIndex(({slotId:e,markerId:r})=>e===t.slotId&&r===t.markerId);-1!==r&&e.value.splice(r,1)};return{slotActivations:(0,n.readonly)(e),addActivation:r=>{t(r),e.value.push(r)},removeActivation:t}})}),l("9QUOw",function(e,t){r(e.exports,"Circle",function(){return o});class o{constructor(e,t,r){this.x=e,this.y=t,this.radius=r}clone(){return new o(this.x,this.y,this.radius)}containsPoint({x:e,y:t}){return(this.x-e)**2+(this.y-t)**2<=this.radius**2}containsCircle(e,t=0){let r=Math.sqrt((this.x-e.x)**2+(this.y-e.y)**2);return r+e.radius<=this.radius+t}static toCircumcircle(e){let t=e.x+e.width/2,r=e.y+e.height/2,n=Math.sqrt(e.width**2+e.height**2)/2;return new o(t,r,n)}static toIncircle(e){let t=e.x+e.width/2,r=e.y+e.height/2,n=Math.min(e.width,e.height)/2;return new o(t,r,n)}}}),l("gbmju",function(e,t){r(e.exports,"render",function(){return l});var o,n=s("djimy");let a=["data-slot-id"],i=(o=()=>/*#__PURE__*/(0,n.createElementVNode)("br",null,null,-1),(0,n.pushScopeId)("data-v-0e606c"),o=o(),(0,n.popScopeId)(),o);function l(e,t,r,o,s,l){return(0,n.openBlock)(),(0,n.createElementBlock)("div",{"data-slot-id":o.slotConfig.id,class:(0,n.normalizeClass)(["slot",{active:o.isActive}]),style:(0,n.normalizeStyle)({"--slot-x":o.slotConfig.x,"--slot-y":o.slotConfig.y,"--slot-radius":o.SLOT_CIRCLE_DIAMETER})},[(0,n.createElementVNode)("div",null,[(0,n.createTextVNode)((0,n.toDisplayString)(o.slotGroupId),1),i,(0,n.createTextVNode)((0,n.toDisplayString)(o.slotConfig.id),1)])],14,a)}}),l("65t20",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("jtxJg",function(e,t){r(e.exports,"render",function(){return a});var o=s("djimy");let n=["data-slot-group-id"];function a(e,t,r,a,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{"data-slot-group-id":a.slotGroupConfig.id},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.slotGroupConfig.slots,e=>((0,o.openBlock)(),(0,o.createBlock)(a.MarkerSlot,{key:e.id,"slot-group-id":a.slotGroupConfig.id,"slot-config":e,onActivate:t[0]||(t[0]=e=>a.numActive+=1),onDeactivate:t[1]||(t[1]=e=>a.numActive-=1)},null,8,["slot-group-id","slot-config"]))),128))],8,n)}}),l("eESbR",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("1VbKL",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("hD1de")).__esModule&&(o=o.default),o.render=s("cqowQ").render,s("eT2xs").default(o),o.__scopeId="data-v-804633",o.__file="ActionCardSlotGroup.vue";var n=o}),l("hD1de",function(e,o){t(e.exports),r(e.exports,"default",function(){return c});var n=s("djimy"),a=s("hWymx"),i=s("cIjax"),l=s("jH98U"),u=s("7RdUk"),c=/*#__PURE__*/(0,n.defineComponent)({__name:"ActionCardSlotGroup",props:{slotGroupConfig:{}},setup(e,{expose:t}){t();let{slotGroupConfig:r}=e,{slotGroups:o}=(0,i.useSlotGroupsStore)(),s=o.find(({id:e})=>e===r.id);(0,a.strict)(void 0!==s);let c=(0,n.ref)(0);(0,n.watchEffect)(()=>{s.parameterTransforms.forEach((e,t)=>{let r=c.value>t;e.active!==r&&(e.active=r)})});let d={props:e,slotGroupConfig:r,slotGroups:o,slotGroup:s,numActive:c,MarkerSlot:l.default,CardSlot:u.default};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}})}),l("7RdUk",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("afxwH")).__esModule&&(o=o.default),o.render=s("l66cW").render,o.__cssModules={},s("4GRYL").default(o),o.__scopeId="data-v-6def15",o.__file="CardSlot.vue";var n=o}),l("afxwH",function(e,o){t(e.exports),r(e.exports,"default",function(){return i});var n=s("djimy"),a=s("7lUOB"),i=/*#__PURE__*/(0,n.defineComponent)({__name:"CardSlot",props:{cardSlotConfig:{},cardConfig:{}},setup(e,{expose:t}){t();let r={props:e,GameCard:a.default};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}})}),l("7lUOB",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("7xQxQ")).__esModule&&(o=o.default),o.render=s("05aqY").render,o.__cssModules={},s("a3cWG").default(o),o.__scopeId="data-v-ca5d72",o.__file="GameCard.vue";var n=o}),l("7xQxQ",function(e,o){t(e.exports),r(e.exports,"default",function(){return i});var n=s("djimy"),a=s("7dQGn"),i=/*#__PURE__*/(0,n.defineComponent)({__name:"GameCard",props:{url:{},label:{},active:{type:Boolean}},setup(e,{expose:t}){t();let{toAssetUrl:r,extractAssetPosition:o}=(0,a.useConfigStore)(),i=(0,n.computed)(()=>r(e.url)),s=(0,n.computed)(()=>o(i.value)),l={props:e,toAssetUrl:r,extractAssetPosition:o,assetUrl:i,position:s};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}})}),l("05aqY",function(e,t){r(e.exports,"render",function(){return i});var o=s("djimy");let n=["src","alt"],a={class:"label"};function i(e,t,r,i,s,l){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:(0,o.normalizeClass)(["action-card",{active:i.props.active}]),style:(0,o.normalizeStyle)({"--card-x":i.position.x,"--card-y":i.position.y})},[(0,o.createElementVNode)("img",{src:i.assetUrl.href,alt:r.label,class:"image"},null,8,n),(0,o.createElementVNode)("div",a,(0,o.toDisplayString)(r.label),1)],6)}}),l("a3cWG",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("l66cW",function(e,t){r(e.exports,"render",function(){return a});var o=s("djimy");let n={class:"label"};function a(e,t,r,a,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{style:(0,o.normalizeStyle)({"--card-x":r.cardSlotConfig.x,"--card-y":r.cardSlotConfig.y,"--card-angle":r.cardSlotConfig.angle}),class:"card-slot"},[(0,o.createElementVNode)("div",n,(0,o.toDisplayString)(r.cardSlotConfig.id),1),null!==r.cardConfig?((0,o.openBlock)(),(0,o.createBlock)(a.GameCard,{key:0,url:r.cardConfig.url,label:r.cardConfig.parameterTransformId,active:!0},null,8,["url","label"])):(0,o.createCommentVNode)("",!0)],4)}}),l("4GRYL",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("cqowQ",function(e,t){r(e.exports,"render",function(){return a});var o=s("djimy");let n=["data-slot-group-id"];function a(e,t,r,a,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{"data-slot-group-id":a.slotGroupConfig.id},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.slotGroupConfig.slots,e=>((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:e.id},[(0,o.createVNode)(a.MarkerSlot,{"slot-group-id":a.slotGroupConfig.id,"slot-config":e.markerSlot},null,8,["slot-group-id","slot-config"]),(0,o.createVNode)(a.CardSlot,{"card-slot-config":e.cardSlot,"card-config":null},null,8,["card-slot-config"])],64))),128))],8,n)}}),l("eT2xs",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("jrojO",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("caiBL")).__esModule&&(o=o.default),o.render=s("jZwyy").render,s("hZr9M").default(o),o.__scopeId="data-v-59b572",o.__file="EventCardSlotGroup.vue";var n=o}),l("caiBL",function(e,o){t(e.exports),r(e.exports,"default",function(){return c});var n=s("djimy"),a=s("hWymx"),i=s("cIjax"),l=s("jH98U"),u=s("llWLg"),c=/*#__PURE__*/(0,n.defineComponent)({__name:"EventCardSlotGroup",props:{slotGroupConfig:{}},setup(e,{expose:t}){t();let{slotGroupConfig:r}=e,{markerSlot:o}=r,{slotGroups:s}=(0,i.useSlotGroupsStore)(),c=s.find(({id:e})=>e===r.id);(0,a.strict)(void 0!==c);let d=(0,n.ref)(!1),p={props:e,slotGroupConfig:r,markerSlotConfig:o,slotGroups:s,slotGroup:c,isMarkerSlotActive:d,MarkerSlot:l.default,EventCardCycler:u.default};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}})}),l("llWLg",function(e,t){let o;r(e.exports,"default",function(){return n}),(o=s("dIE4t")).__esModule&&(o=o.default),o.render=s("9hTqD").render,s("9NrRY").default(o),o.__scopeId="data-v-492216",o.__file="EventCardCycler.vue";var n=o}),l("dIE4t",function(e,o){t(e.exports),r(e.exports,"default",function(){return c});var n=s("djimy"),a=s("hWymx"),i=s("9OMm5"),l=s("cIjax"),u=s("7RdUk"),c=/*#__PURE__*/(0,n.defineComponent)({__name:"EventCardCycler",props:{slotGroupConfig:{},enabled:{type:Boolean}},setup(e,{expose:t}){t();let{minDelayMs:r,maxDelayMs:o,minDurationMs:s,maxDurationMs:c}=e.slotGroupConfig,{slotGroups:d}=(0,l.useSlotGroupsStore)(),p=d.find(({id:t})=>t===e.slotGroupConfig.id);(0,a.strict)(void 0!==p);let f=(e=1)=>e*r+Math.random()*Math.abs(o-r),m=()=>s+Math.random()*Math.abs(c-s),h=(0,n.reactive)(e.slotGroupConfig.cardSlots.map(e=>({cardSlotConfig:e,cardConfig:null,stopFilling:()=>{}})));(0,a.strict)(h.length>0),(0,a.strict)(e.slotGroupConfig.cards.length>0),(0,a.strict)(h.length<=e.slotGroupConfig.cards.length);let g=e.slotGroupConfig.cards.map(e=>{let t=p.parameterTransforms.find(t=>t.id===e.parameterTransformId);return(0,a.strict)(void 0!==t),{cardConfig:e,parameterTransform:t}}),b=()=>{let e=g.shift();return(0,a.strict)(void 0!==e),g.push(e),e},y=e=>{e.stopFilling();let{cardConfig:t,parameterTransform:r}=b();e.cardConfig=t,r.active=!0;let o=m(),n=f();e.stopFilling(),e.stopFilling=(0,i.useTimeoutFn)(()=>y(e),o+n).stop,(0,i.useTimeoutFn)(()=>{e.cardConfig=null,r.active=!1},o)},_=()=>{let e=0;h.forEach(t=>{if(null===t.cardConfig){let r=f(e);t.stopFilling(),t.stopFilling=(0,i.useTimeoutFn)(()=>y(t),r).stop,e+=1}})},S=()=>{h.forEach(e=>e.stopFilling())};(0,n.watch)(()=>e.enabled,(e,t)=>{e!==t&&(e?_():S())},{immediate:!0});let x={props:e,minDelayMs:r,maxDelayMs:o,minDurationMs:s,maxDurationMs:c,slotGroups:d,slotGroup:p,getRandomDelayMs:f,getRandomDurationMs:m,cardSlotAssignments:h,eventCardPriorityQueue:g,getNextEventCard:b,fillCardSlot:y,activateCardSlotAssignments:_,deactivateCardSlotAssignments:S,CardSlot:u.default};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}})}),l("9hTqD",function(e,t){r(e.exports,"render",function(){return n});var o=s("djimy");function n(e,t,r,n,a,i){return(0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.cardSlotAssignments,e=>((0,o.openBlock)(),(0,o.createBlock)(n.CardSlot,{key:e.cardSlotConfig.id,"card-slot-config":e.cardSlotConfig,"card-config":e.cardConfig},null,8,["card-slot-config","card-config"]))),128)}}),l("9NrRY",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("jZwyy",function(e,t){r(e.exports,"render",function(){return a});var o=s("djimy");let n=["data-slot-group-id"];function a(e,t,r,a,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{"data-slot-group-id":a.slotGroupConfig.id},[(0,o.createVNode)(a.MarkerSlot,{"slot-group-id":a.slotGroupConfig.id,"slot-config":a.markerSlotConfig,onActivate:t[0]||(t[0]=e=>a.isMarkerSlotActive=!0),onDeactivate:t[1]||(t[1]=e=>a.isMarkerSlotActive=!1)},null,8,["slot-group-id","slot-config"]),(0,o.createVNode)(a.EventCardCycler,{"slot-group-config":a.slotGroupConfig,enabled:a.isMarkerSlotActive},null,8,["slot-group-config","enabled"])],8,n)}}),l("hZr9M",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),l("dNJei",function(e,t){r(e.exports,"Scores",function(){return n});var o=s("hWymx");class n{static circularity(e){let{produceFromNaturalResources:t,acquireNewlyProduced:r,acquireUsed:n,acquireRepaired:a,acquireRefurbished:i,disposeHibernating:s,disposeBroken:l,landfill:u}=e.flows,c=Math.min(1-Math.min(1,t/(r+n+a+i)),1-Math.min(1,u/(s+l)));return!Number.isFinite(c)||Number.isNaN(c)?0:((0,o.strict)(c>=0&&c<=1,"circularity should be between 0 and 1"),c)}static userSatifaction(e){let{phonesInUse:t}=e.stocks,{phoneGoal:r}=e.variables,n=t<r?t/r:r/t;return!Number.isFinite(n)||Number.isNaN(n)?0:((0,o.strict)(n>=0&&n<=1,"userSatisfaction should be between 0 and 1"),n)}static all(e){let t=n.circularity(e),r=n.userSatifaction(e);return{circularity:t,userSatisfaction:r}}}}),l("8C4qt",function(e,t){r(e.exports,"ignorePromise",function(){return o});function o(e){}}),l("k5vMz",function(e,t){r(e.exports,"render",function(){return d});var o,n=s("djimy");let a={class:"fill"},i={id:"illustration-panel",class:"illustration-panel fill"},l={ref:"",class:"viz-panel fill"},u=(o=()=>/*#__PURE__*/(0,n.createElementVNode)("div",{id:"model-viz-container",class:"model-viz-container"},null,-1),(0,n.pushScopeId)("data-v-0cd1fb"),o=o(),(0,n.popScopeId)(),o),c={class:"slot-panel fill"};function d(e,t,r,o,s,d){return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createElementVNode)("div",a,[(0,n.createElementVNode)("div",i,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(o.config.triggers,e=>((0,n.openBlock)(),(0,n.createBlock)(o.TriggeredOverlay,{key:e.id,"trigger-config":e},null,8,["trigger-config"]))),128))]),(0,n.createElementVNode)("div",l,[u,(0,n.createVNode)(o.ScoreItem,{title:"Circularity",value:o.circularityScore,class:"score circularity-index"},null,8,["value"]),(0,n.createVNode)(o.ScoreItem,{title:"User Satisfaction",value:o.userSatisfactionScore,class:"score user-satisfaction"},null,8,["value"])],512),(0,n.createElementVNode)("div",c,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(o.config.interaction.slotGroups,e=>((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:e.id},["basic"===e.type?((0,n.openBlock)(),(0,n.createBlock)(o.BasicSlotGroup,{key:0,"slot-group-config":e},null,8,["slot-group-config"])):(0,n.createCommentVNode)("",!0),"action-card"===e.type?((0,n.openBlock)(),(0,n.createBlock)(o.ActionCardSlotGroup,{key:1,"slot-group-config":e},null,8,["slot-group-config"])):(0,n.createCommentVNode)("",!0),"event-card"===e.type?((0,n.openBlock)(),(0,n.createBlock)(o.EventCardSlotGroup,{key:2,"slot-group-config":e},null,8,["slot-group-config"])):(0,n.createCommentVNode)("",!0)],64))),128)),o.options.usePointerMarkers?((0,n.openBlock)(),(0,n.createBlock)(o.PointerMarkerPanel,{key:0})):(0,n.createCommentVNode)("",!0),o.options.useTuioMarkers?((0,n.openBlock)(),(0,n.createBlock)(o.TuioMarkerPanel,{key:1,class:"pointer-events-fallthrough"})):(0,n.createCommentVNode)("",!0)])]),(0,n.createVNode)(o.ControlPanel,{onKeydown:t[0]||(t[0]=e=>e.stopPropagation()),disabled:!o.enableControlPanel},null,8,["disabled"])],64)}}),l("feskM",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}});var u=s("ggKaZ"),c=s("djimy"),d=s("kV0Ly");s("5jyqD").Tab;var p=s("f4LB1"),f=s("i5N9G");(e=s("fkeW0")).__esModule&&(e=e.default),e.render=s("k5vMz").render,e.__cssModules={},s("feskM").default(e),e.__scopeId="data-v-0cd1fb",e.__file="App.vue";var m=e,h=s("jTevu"),g=s("fWsyq"),b=s("krAM6");function y(e,t){return t}class _{static async fetch(e){let t=await fetch(e);if(!t.ok)throw Error(`Failed to load config file '${e.toString()}': ${t.statusText}`);let r=await t.text(),o=(0,h.default).load(r,{schema:h.default.JSON_SCHEMA});if("object"!=typeof o||null===o)throw Error(`Failed to parse config file '${e.toString()}': ${JSON.stringify(o)}`);return o}static async safeLoad(...e){let t=await Promise.all(e.map(async e=>[e,await _.fetch(e)])),r=/*@__PURE__*/o(g).all(t.map(([e,t])=>t),{arrayMerge:y}),n=(0,b.validateConfig)(r);return n.ok?{ok:!0,data:n.data}:{ok:!1,error:{config:{merged:r,segments:t},error:n.error}}}static async load(...e){let t=await _.safeLoad(...e);if(!t.ok)throw t.error;return t.data}}async function S(){return new Promise(e=>{let t=document.readyState;("complete"===t||"interactive"===t)&&setTimeout(e,0),document.addEventListener("DOMContentLoaded",()=>e())})}var x=s("hWymx");class k{constructor(e,t){let{parentElement:r}=e;(0,x.strict)(null!==r,"element must have a parent"),this.observer=new ResizeObserver(()=>k.fit(e,r,t)),this.observer.observe(r),k.fit(e,r,t)}disconnect(){this.observer.disconnect()}static fit(e,t,r){let o=t.getBoundingClientRect(),n=Math.min(o.width/r.width,o.height/r.height),a=e.style;a.width=`${r.width}px`,a.height=`${r.height}px`,a.transformOrigin="top left",a.transform=`translate(${o.width/2}px, ${o.height/2}px) scale(${n}) translate(-50%, -50%)`}}function T(e,t,r=document){let o=r.querySelector(t);if(null===o)throw Error(`No element found matching selector ${t}.`);if(!(o instanceof e))throw Error(`Element matching selector ${t} has the wrong type.`);return o}var x=s("hWymx"),P=s("lOERq");/**
 * Loads an external SVG file and returns the DOM tree of its first <svg> element.
 *
 * @param {string|URL} uri
 * @param {boolean} clearStyles
 *  If true removes the style elements from the file
 * @return {Promise<SVGSVGElement>}
 */async function C(e,t=!0){let r=await fetch(e);if(r.status<200||r.status>=300)throw Error(`Server returned status ${r.status} (${r.statusText}) loading ${new URL(e).href}.`);let o=await r.text(),n=document.createElement("div");n.innerHTML=o;let a=n.querySelector("svg");if(null===a)throw Error(`No SVG element found in ${new URL(e).href}.`);return t&&a.querySelectorAll("style")?.forEach(e=>e.remove()),a}var I={};I=s("5CpQN").getBundleURL("6xGL6")+"model.e7e8056e.svg";let E=new URL(I),M=["abandon","acquireNewlyProduced","acquireRefurbished","acquireRepaired","acquireUsed","disposeBroken","disposeHibernating","goBroken","landfill","produceFromNaturalResources","produceFromRecycledMaterials","recycle","refurbish","repair"],w={"recycled-materials":"Verwertungsanlage","hibernating-phones":"Ungenutzte Handies","disposed-phones":"Handies im M\xfcll","broken-phones":"Kaputte Handies","repaired-phones":"Werkstatt","phones-in-use":"Handies in Benutzung","refurbished-phones":"Instandsetzung","newly-produced-phones":"Handy-Fabrik","natural-resources":"Natur","landfilled-phones":"Deponie"},R={abandon:1,acquireNewlyProduced:-1,acquireRefurbished:-1,acquireRepaired:-1,acquireUsed:-1,disposeBroken:-1,disposeHibernating:-1,goBroken:-1,landfill:-1,produceFromNaturalResources:-1,produceFromRecycledMaterials:-1,recycle:-1,refurbish:-1,repair:-1},O=10*Math.sqrt(300),A=300+O;console.log(300,O,A);class N{constructor(e,t){this.model=e,this.svg=t,this.element=document.createElement("div"),this.element.append(this.svg)}updateSvgFlows(e,t,r){let{flows:n}=r,a=t*(3e4/r.parameters.numberOfUsers)/A;M.forEach(t=>{let r=n[t],i=R[t],s=`${/*@__PURE__*/o(P)(t)}-flow`,l=T(SVGPathElement,`#${s}`,this.svg),u=parseFloat(l.getAttribute("stroke-dashoffset")??"0"),c=(Number.isNaN(u)?0:u)+Math.max(-9,Math.min(i*(e*r)*a,3));l.setAttribute("stroke-dashoffset",`${c}`),l.setAttribute("stroke-dasharray","0 30")})}updateSvgStocks(e,t,r){let{stocks:n}=r,a=3e4/r.parameters.numberOfUsers;this.model.stockIds.forEach(e=>{let t=/*@__PURE__*/o(P)(e),r=this.svg.getElementById(t);if(null===r)throw Error(`SVG element with id ${t} for stock ${e} not found.`);if(!(r instanceof SVGCircleElement))throw Error(`Stock element for stock ${e} with id ${t} is not an SVG circle element.`);let i=n[e];r.setAttribute("r",`${Math.sqrt(i*a/Math.PI)}`)})}updateSvg(e,t,r){this.updateSvgFlows(e,t,r),this.updateSvgStocks(e,t,r)}update(e,t,r){this.updateSvg(e,t,r)}static prepareSvg(e,t){let r=e=>t.ownerDocument.createElementNS("http://www.w3.org/2000/svg",e);t.classList.add("model-visualization"),t.querySelectorAll("circle, rect, path, text").forEach(e=>{e.removeAttribute("style")});let n=[...t.children],a=r("g");a.classList.add("labels");let i=r("g");i.classList.add("supplies");let s=r("g");s.classList.add("capacities");let l=r("g");l.classList.add("flows"),t.append(s,l,i,a),t.querySelectorAll("text").forEach(e=>{n.push(e)}),Object.entries(w).forEach(([e,o])=>{let n=T(SVGGeometryElement,`#${e}`,t);(0,x.strict)("circle"===n.tagName||"rect"===n.tagName);let{x:i,y:s}="circle"===n.tagName?function(e){let t=parseFloat(e.getAttribute("cx")??"");(0,x.strict)(!Number.isNaN(t));let r=parseFloat(e.getAttribute("cy")??"");return(0,x.strict)(!Number.isNaN(r)),{x:t,y:r}}(n):function(e){let t=parseFloat(e.getAttribute("x")??"");(0,x.strict)(!Number.isNaN(t));let r=parseFloat(e.getAttribute("y")??"");(0,x.strict)(!Number.isNaN(r));let o=parseFloat(e.getAttribute("width")??"");(0,x.strict)(!Number.isNaN(o));let n=parseFloat(e.getAttribute("height")??"");return(0,x.strict)(!Number.isNaN(n)),{x:t+o/2,y:r+n/2}}(n),{foreignObjectElement:l,divElement:u}=function(e,t,o,n){let a=r("foreignObject");a.setAttribute("x",`${e}`),a.setAttribute("y",`${t}`),a.setAttribute("width","200"),a.setAttribute("height","50");let i=a.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","div");return a.append(i),{foreignObjectElement:a,divElement:i}}(i,s,0,0);u.textContent=o,u.classList.add("label"),a.append(l)}),t.querySelectorAll("rect").forEach(e=>{let t=e.cloneNode(!1);t.classList.add("capacity"),s.append(t)}),e.stockIds.filter(e=>e.startsWith("supplyOf")).forEach(e=>{let r=/*@__PURE__*/o(P)(e.replace(/^supplyOf/,"")),n=T(SVGGeometryElement,`#${r}`,t),a=n.cloneNode(!1);a.id=`supply-of-${n.id}`,a.classList.add("stock","supply"),i.append(a)});let u=T(SVGGeometryElement,"#phones-in-use",t),c=u.cloneNode(!1);i.append(c),e.stockIds.filter(e=>e.startsWith("capacityOf")).forEach(e=>{let r=/*@__PURE__*/o(P)(e.replace(/^capacityOf/,"")),n=T(SVGGeometryElement,`#${r}`,t),a=n.cloneNode(!1);a.id=`capacity-of-${r}`,a.classList.add("stock","capacity"),s.append(a)}),M.forEach(e=>{let r=/*@__PURE__*/o(P)(e),n=T(SVGGeometryElement,`#${r}`,t),a=n.cloneNode(!1);a.id=`${r}-edge`,a.removeAttribute("style"),a.classList.add("flow","edge"),l.append(a);let i=n.cloneNode(!1);i.id=`${r}-flow`,i.removeAttribute("style"),i.classList.add("flow","anim-edge"),l.append(i)}),n.forEach(e=>e.remove())}static async create(e){let t=await C(E);return this.prepareSvg(e,t),new N(e,t)}}var j=s("aDsGb");class B{constructor(e,t,r,o,n,a){this.model=e,this.parameters=r,this.flowPerStockCache=null,this.record=this.model.evaluate(t,r,o),this.deltaPerSecond=n,this.maxStepSize=a,this.flowEvaluator=this.model.createFlowEvaluator(r),this.flowEvaluatorWithCache=this.evaluateFlowPerStockWithCache.bind(this)}evaluateFlowPerStockWithCache(e,t){return null!==this.flowPerStockCache&&this.flowPerStockCache.t===t?[...this.flowPerStockCache.value]:this.flowEvaluator(e,t)}tick(e){let t=this.record.t+e*this.deltaPerSecond;for(;this.record.t<t;){let e=Math.min(this.maxStepSize,t-this.record.t);this.step(e)}return this.record}step(e){let{stocks:t,parameters:r,t:o}=this.record,n=this.model.step(t,o,e,this.flowEvaluatorWithCache),a=this.model.evaluate(n,r,o+e);return this.flowPerStockCache={t:a.t,value:this.model.stocksToStockArray(this.model.accumulateFlowsPerStock(a.flows))},this.record=a,a}}var F=s("3ZGF0"),x=s("hWymx"),G=s("8C4qt");function D(){let e=document.timeline?.currentTime;return null==e?performance.now():"number"==typeof e?e:e.to("ms").value}class V extends F.EventEmitter{play(){this.shouldRun=!0,(0,G.ignorePromise)(this.run())}pause(){this.shouldRun=!1,null!==this.cancelAnimationFrameCallback&&this.cancelAnimationFrameCallback()}isPlaying(){return this.running}isPaused(){return!this.running}shouldPlay(){return this.shouldRun}shouldPause(){return!this.shouldRun}togglePlayPause(){this.shouldRun?this.pause():this.play()}tick(){this.isPlaying()?((0,x.strict)(null!==this.cancelAnimationFrameCallback),this.cancelAnimationFrameCallback()):(this.play(),this.pause())}async run(){if(this.running||!this.shouldRun)return;this.running=!0,this.emit("play");// Keep track of the offset between this runner and the global animation time.
// The offset increases by the time the runner was paused.
let e=D();this.timeStampOffset+=e-this.lastTimeStamp,// The first tick will be emitted with a delta of 0, i.e. the attached listeners should not progress.
// If renderers are attached, they should just render the current state.
this.lastTimeStamp=e;do{let t=e-this.lastTimeStamp;// Account for the case where the runner has been paused during the tick event
if(this.emit("tick",t,e,this.lastTimeStamp,this.timeStampOffset),this.lastTimeStamp=e,!this.shouldRun)break;try{// Wait for the next animation frame
// eslint-disable-next-line no-await-in-loop
e=await new Promise((e,t)=>{let r=requestAnimationFrame(e);this.cancelAnimationFrameCallback=()=>{cancelAnimationFrame(r),this.cancelAnimationFrameCallback=null,this.shouldRun?e(D()):t()}})}catch(e){// The runner was paused while waiting for the next animation frame
}}while(this.shouldRun)this.running=!1,this.emit("pause")}constructor(...e){super(...e),this.shouldRun=!1,this.running=!1,this.timeStampOffset=0,this.lastTimeStamp=D(),this.cancelAnimationFrameCallback=null}}class L{constructor(e,t,r,o){this.element=e,this.config=o,this.modelSimulator=new B(t,{...o.model.initialStocks},{...o.model.initialParameters},0,o.simulation.deltaPerSecond,o.simulation.maxStepSize),this.modelView=r,this.element.append(this.modelView.element),this.runner=new V,this.runner.on("tick",this.tick.bind(this))}tick(e){let{t:t}=this.modelSimulator.record;this.modelSimulator.tick(e);let{t:r}=this.modelSimulator.record;this.modelView.update(e,r-t,this.modelSimulator.record)}static async create(e,t){let r=new j.CircularEconomyModel,o=await N.create(r);return new L(e,r,o,t)}}var q=s("7Rjir");async function U(){let e=await _.safeLoad(...q.CONFIG_URLS);if(!e.ok){let{config:t,error:{errors:r,explanation:o}}=e.error;throw console.error("Invalid configuration:",t),console.error(o),console.error("Issues reported by the configuration validator:",...r??[]),Error("Error loading configuration. See console for details.")}let t=e.data;console.log(t);let r=document.documentElement.style;r.setProperty("--app-width",`${q.BOARD_WIDTH}`),r.setProperty("--app-height",`${q.BOARD_HEIGHT}`);let o=T(HTMLDivElement,"#fixed-size-container");new k(o,{width:q.BOARD_WIDTH,height:q.BOARD_HEIGHT});let n=(0,d.createPinia)(),a=(0,c.createApp)(m);a.provide(q.CONFIG_INJECTION_KEY,t),a.use(n);let i=a.mount(o),s=(0,p.useAppStore)(),l=(0,f.useModelStore)(),h=T(HTMLDivElement,"#model-viz-container"),g=await L.create(h,t);return g.runner.on("tick",()=>{let{record:e}=g.modelSimulator;l.$patch({record:e})}),(0,c.watchEffect)(()=>{s.isPlaying?g.runner.play():g.runner.pause()}),(0,c.watchEffect)(()=>{Object.assign(g.modelSimulator.parameters,{...l.transformedParameters}),console.log("Update model parameters",g.modelSimulator.parameters)}),g.runner.tick(),(0,u.default)("space",()=>(g.runner.togglePlayPause(),!1)),{app:i,game:g}}// This is for setting global Vue.js option that should actually be set by the bundler, but aren't.
/* eslint-disable */// @ts-ignore
globalThis.__VUE_OPTIONS_API__=!0,// @ts-ignore
globalThis.__VUE_PROD_DEVTOOLS__=!0,// @ts-ignore
globalThis.__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!0,window.circularEconomy=S().then(U)}();//# sourceMappingURL=index.9272f69e.js.map

//# sourceMappingURL=index.9272f69e.js.map
